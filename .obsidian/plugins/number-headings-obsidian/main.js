/*
THIS IS A GENERATED/BUNDLED FILE BY ROLLUP
if you want to view the source visit the plugins github repository
*/

'use strict';

var obsidian = require('obsidian');

/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */

function __awaiter(thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
}

function getActiveView(app) {
    const activeView = app.workspace.getActiveViewOfType(obsidian.MarkdownView);
    return activeView !== null && activeView !== void 0 ? activeView : undefined;
}
function isViewActive(app) {
    const activeView = getActiveView(app);
    if (activeView && activeView.file)
        return true;
    return false;
}
function getViewMetadata(app) {
    const activeView = getActiveView(app);
    if (activeView && activeView.file) {
        const data = app.metadataCache.getFileCache(activeView.file) || {};
        return data;
    }
    return undefined;
}
function getViewInfo(app) {
    const activeView = getActiveView(app);
    const data = getViewMetadata(app);
    const editor = activeView ? activeView.editor : undefined;
    if (activeView && data && editor) {
        return {
            activeView, data, editor
        };
    }
    return undefined;
}

const DEFAULT_SETTINGS = {
    skipTopLevel: false,
    firstLevel: 1,
    maxLevel: 6,
    styleLevel1: '1',
    styleLevelOther: '1',
    auto: false,
    separator: '',
    contents: ''
};
function isValidLevelStyle(s) {
    if (s === 'A' || s === '1')
        return true;
    return false;
}
function isValidFlag(f) {
    if (f === true || f === false)
        return true;
    return false;
}
function isValidFirstOrMaxLevel(x) {
    if (typeof x === 'number' && x >= 1 && x <= 6)
        return true;
    return false;
}
function isValidSeparator(x) {
    if (typeof x === 'string' && (x === '' || x === ':' || x === '.' || x === '-'))
        return true;
    return false;
}
function isValidContents(x) {
    if (typeof x === 'string' && (x === '' || x.startsWith('^')))
        return true;
    return false;
}
function doesContentsHaveValue(x) {
    if (x.length > 2 && x.startsWith('^'))
        return true;
    return false;
}

const AUTO_PART_KEY = 'auto';
const FIRST_LEVEL_PART_KEY = 'first-level';
const MAX_LEVEL_PART_KEY = 'max';
const CONTENTS_PART_KEY = 'contents';
function parseCompactFrontMatterSettings(fm) {
    const entry = obsidian.parseFrontMatterEntry(fm, 'number headings');
    if (entry) {
        const entryString = String(entry);
        const parts = entryString.split(',');
        const settings = Object.assign({}, DEFAULT_SETTINGS);
        for (const part of parts) {
            const cleanPart = part.trim();
            if (cleanPart.length === 0)
                continue;
            if (cleanPart === AUTO_PART_KEY) {
                // Parse auto numbering part
                settings.auto = true;
            }
            else if (cleanPart.startsWith(FIRST_LEVEL_PART_KEY)) {
                // Parse first level part
                const nstring = cleanPart.substring(FIRST_LEVEL_PART_KEY.length + 1);
                const n = parseInt(nstring);
                if (isValidFirstOrMaxLevel(n)) {
                    settings.firstLevel = n;
                }
            }
            else if (cleanPart.startsWith(MAX_LEVEL_PART_KEY)) {
                // Parse max level part
                const nstring = cleanPart.substring(MAX_LEVEL_PART_KEY.length + 1);
                const n = parseInt(nstring);
                if (isValidFirstOrMaxLevel(n)) {
                    settings.maxLevel = n;
                }
            }
            else if (cleanPart.startsWith(CONTENTS_PART_KEY)) {
                if (cleanPart.length <= CONTENTS_PART_KEY.length + 1)
                    continue;
                // Parse contents heading part
                const tocHeading = cleanPart.substring(CONTENTS_PART_KEY.length + 1);
                if (isValidContents(tocHeading)) {
                    settings.contents = tocHeading;
                }
            }
            else {
                // Parse formatting part
                const lastChar = cleanPart[cleanPart.length - 1];
                let remainingPart = cleanPart;
                if (isValidSeparator(lastChar)) {
                    settings.separator = lastChar;
                    remainingPart = cleanPart.substring(0, cleanPart.length - 1);
                }
                const descriptors = remainingPart.split('.');
                let firstNumberedDescriptor = 0;
                if (descriptors.length > 1 && descriptors[0] === '_') {
                    settings.skipTopLevel = true;
                    firstNumberedDescriptor = 1;
                }
                else {
                    settings.skipTopLevel = false;
                }
                if (descriptors.length - firstNumberedDescriptor >= 2) {
                    const styleLevel1 = descriptors[firstNumberedDescriptor];
                    if (isValidLevelStyle(styleLevel1)) {
                        settings.styleLevel1 = styleLevel1;
                    }
                    const styleLevelOther = descriptors[firstNumberedDescriptor + 1];
                    if (isValidLevelStyle(styleLevelOther)) {
                        settings.styleLevelOther = styleLevelOther;
                    }
                }
            }
        }
        return settings;
    }
    return undefined;
}
const getFrontMatterSettingsOrAlternative = ({ frontmatter }, alternativeSettings) => {
    var _a, _b, _c, _d, _e;
    if (frontmatter !== undefined) {
        const decompactedSettings = parseCompactFrontMatterSettings(frontmatter);
        if (decompactedSettings !== undefined)
            return decompactedSettings;
        // NOTE: Everything below is for backwards compatibility only
        const skipTopLevelEntry = (_a = obsidian.parseFrontMatterEntry(frontmatter, 'number-headings-skip-top-level')) !== null && _a !== void 0 ? _a : obsidian.parseFrontMatterEntry(frontmatter, 'header-numbering-skip-top-level');
        const skipTopLevel = isValidFlag(skipTopLevelEntry) ? skipTopLevelEntry : alternativeSettings.skipTopLevel;
        const maxLevelEntry = (_b = obsidian.parseFrontMatterEntry(frontmatter, 'number-headings-max-level')) !== null && _b !== void 0 ? _b : obsidian.parseFrontMatterEntry(frontmatter, 'header-numbering-max-level');
        const maxLevel = isValidFirstOrMaxLevel(maxLevelEntry) ? maxLevelEntry : alternativeSettings.maxLevel;
        const styleLevel1Entry = String((_c = obsidian.parseFrontMatterEntry(frontmatter, 'number-headings-style-level-1')) !== null && _c !== void 0 ? _c : obsidian.parseFrontMatterEntry(frontmatter, 'header-numbering-style-level-1'));
        const styleLevel1 = isValidLevelStyle(styleLevel1Entry) ? styleLevel1Entry : alternativeSettings.styleLevel1;
        const styleLevelOtherEntry = String((_d = obsidian.parseFrontMatterEntry(frontmatter, 'number-headings-style-level-other')) !== null && _d !== void 0 ? _d : obsidian.parseFrontMatterEntry(frontmatter, 'header-numbering-style-level-other'));
        const styleLevelOther = isValidLevelStyle(styleLevelOtherEntry) ? styleLevelOtherEntry : alternativeSettings.styleLevelOther;
        const autoEntry = (_e = obsidian.parseFrontMatterEntry(frontmatter, 'number-headings-auto')) !== null && _e !== void 0 ? _e : obsidian.parseFrontMatterEntry(frontmatter, 'header-numbering-auto');
        const auto = isValidFlag(autoEntry) ? autoEntry : alternativeSettings.auto;
        return Object.assign(Object.assign({}, alternativeSettings), { skipTopLevel, maxLevel, styleLevel1, styleLevelOther, auto });
    }
    else {
        return alternativeSettings;
    }
};
function settingsToCompactFrontMatterValue(settings) {
    const autoPart = settings.auto ? 'auto, ' : '';
    const firstLevelPart = `first-level ${settings.firstLevel}, `;
    const maxPart = `max ${settings.maxLevel}, `;
    const contentsPart = settings.contents && settings.contents.length > 0 ? `contents ${settings.contents}, ` : '';
    const skipTopLevelString = settings.skipTopLevel ? '_.' : '';
    const stylePart = `${skipTopLevelString}${settings.styleLevel1}.${settings.styleLevelOther}${settings.separator}`;
    return autoPart + firstLevelPart + maxPart + contentsPart + stylePart;
}
function findLineWhichStartsWith(editor, search, afterLine) {
    // Find the location of the frontmatter
    for (let i = afterLine; i < editor.lastLine(); i++) {
        const lineString = editor.getLine(i);
        if (lineString.startsWith(search)) {
            return i;
        }
    }
    return undefined;
}
const saveSettingsToFrontMatter = ({ frontmatter }, editor, settings) => {
    if (frontmatter !== undefined) {
        // Front matter already exists, so we'll need to insert the settings into the front matter
        const frontMatterLine = frontmatter.position.start.line;
        const v = settingsToCompactFrontMatterValue(settings);
        const frontMatterAdditions = `number headings: ${v}\n`;
        if (frontmatter['number headings'] !== undefined) {
            // Key already present, replace it
            const keyLine = findLineWhichStartsWith(editor, 'number headings', frontMatterLine);
            if (keyLine === undefined)
                throw new Error('Number Headings Plugin: "number headings" key exists but not found.');
            const from = { line: keyLine, ch: 0 };
            const to = { line: keyLine + 1, ch: 0 };
            editor.replaceRange(frontMatterAdditions, from, to);
        }
        else {
            // Key not present, insert new key
            const from = { line: frontMatterLine + 1, ch: 0 };
            const to = { line: frontMatterLine + 1, ch: 0 };
            editor.replaceRange(frontMatterAdditions, from, to);
        }
    }
    else {
        // No frontmatter found, create frontmatter from scratch
        const v = settingsToCompactFrontMatterValue(settings);
        const newFrontMatter = `---\nnumber headings: ${v}\n---\n\n`;
        const from = { line: 0, ch: 0 };
        const to = { line: 0, ch: 0 };
        editor.replaceRange(newFrontMatter, from, to);
        // Front matter does not exist, so we will create it from scratch
    }
};

class NumberingDoneModal extends obsidian.Modal {
    constructor(app, config) {
        super(app);
        this.config = config;
    }
    onOpen() {
        const { contentEl, titleEl } = this;
        titleEl.setText('Number Headings - Successfully Completed');
        contentEl.createEl('div', { text: this.config.message });
        contentEl.createEl('pre', { text: this.config.preformattedMessage });
        contentEl.createEl('div', { text: "Do you want to save these settings in the document's front matter?", cls: 'number-headings-question' });
        const containerForButtons = contentEl.createEl('div', { cls: 'number-headings-button-container' });
        const noButton = containerForButtons.createEl('button', {});
        noButton.setText('No');
        noButton.onClickEvent((ev) => {
            this.close();
            return ev;
        });
        const yesButton = containerForButtons.createEl('button', {});
        yesButton.setText('Yes, save settings in document');
        yesButton.onClickEvent((ev) => {
            this.config.saveSettingsCallback(false);
            this.close();
            return ev;
        });
        const yesAndAutoButton = containerForButtons.createEl('button', {});
        yesAndAutoButton.setText('Yes, save settings in document, and automatically number');
        yesAndAutoButton.onClickEvent((ev) => {
            this.config.saveSettingsCallback(true);
            this.close();
            return ev;
        });
    }
    onClose() {
        const { contentEl, titleEl } = this;
        contentEl.empty();
        titleEl.empty();
    }
}
function showNumberingDoneMessage(app, config) {
    const leaf = app.workspace.activeLeaf;
    if (leaf) {
        new NumberingDoneModal(app, config).open();
    }
}

const TOC_LIST_ITEM_BULLET = '-';
function makeHeadingHashString(editor, heading) {
    const regex = /^\s{0,4}#+/g;
    const headingLineString = editor.getLine(heading.position.start.line);
    if (!headingLineString)
        return undefined;
    const matches = headingLineString.match(regex);
    if (!matches)
        return undefined;
    if (matches.length !== 1) {
        // eslint-disable-next-line no-console
        console.log("Unexpected heading format: '" + headingLineString + "'");
        return undefined;
    }
    const match = matches[0];
    return match.trimLeft();
}
function makeNumberingString(numberingStack) {
    let numberingString = '';
    for (let i = 0; i < numberingStack.length; i++) {
        if (i === 0) {
            numberingString += ' ';
        }
        else {
            numberingString += '.';
        }
        numberingString += numberingStack[i].toString();
    }
    return numberingString;
}
function getHeadingPrefixRange(editor, heading) {
    const regex = /^\s{0,4}#+( )?([0-9]+\.|[A-Z]\.)*([0-9]+|[A-Z])?[:.-]?( )+/g;
    const headingLineString = editor.getLine(heading.position.start.line);
    if (!headingLineString)
        return undefined;
    const matches = headingLineString.match(regex);
    if (matches && matches.length !== 1) {
        // eslint-disable-next-line no-console
        console.log("Unexpected heading format: '" + headingLineString + "'");
        return undefined;
    }
    const match = matches ? matches[0] : '';
    const from = {
        line: heading.position.start.line,
        ch: 0
    };
    const to = {
        line: heading.position.start.line,
        ch: match.length
    };
    return { from, to };
}
function zerothNumberingTokenInStyle(style) {
    if (style === '1') {
        return 0;
    }
    else if (style === 'A') {
        return 'Z';
    }
    return 0;
}
function firstNumberingTokenInStyle(style) {
    if (style === '1') {
        return 1;
    }
    else if (style === 'A') {
        return 'A';
    }
    return 1;
}
function nextNumberingToken(t) {
    if (typeof t === 'number') {
        return t + 1;
    }
    if (typeof t === 'string') {
        if (t === 'Z')
            return 'A';
        else
            return String.fromCharCode(t.charCodeAt(0) + 1);
    }
    return 1;
}
function cleanHeadingTextForToc(htext) {
    if (htext.contains('^')) {
        const x = htext.split('^');
        if (x.length > 1) {
            return x[0].trim();
        }
    }
    return htext.trim();
}
// eslint-disable-next-line @typescript-eslint/no-unused-vars
function createTocEntry(h, settings) {
    const text = h.heading;
    const cleanText = cleanHeadingTextForToc(text);
    let bulletIndent = '';
    const startLevel = 1;
    for (let i = startLevel; i < h.level; i++) {
        bulletIndent += '\t';
    }
    const entryLink = `[[#${text}|${cleanText}]]`;
    return bulletIndent + TOC_LIST_ITEM_BULLET + ' ' + entryLink;
}
// Replace a range, but only if there is a change in text, to prevent poluting the undo stack
function replaceRangeSafely(editor, changes, range, text) {
    const previousText = editor.getRange(range.from, range.to);
    if (previousText !== text) {
        changes.push({
            text: text,
            from: range.from,
            to: range.to
        });
    }
}
const updateHeadingNumbering = (viewInfo, settings) => {
    var _a;
    if (!viewInfo)
        return;
    const headings = (_a = viewInfo.data.headings) !== null && _a !== void 0 ? _a : [];
    const editor = viewInfo.editor;
    let previousLevel = 1;
    const numberingStack = [zerothNumberingTokenInStyle(settings.styleLevel1)];
    if (settings.firstLevel > 1) {
        previousLevel = settings.firstLevel;
    }
    else if (settings.skipTopLevel) {
        previousLevel = 2;
    }
    const changes = [];
    for (const heading of headings) {
        // Update the numbering stack based on the level and previous level
        const level = heading.level;
        // Handle skipped & ignored levels
        if (settings.firstLevel > level) {
            // Leave these headings as they are (this allows people to have numbers at the start of ignored headings)
            continue;
        }
        else if ((settings.skipTopLevel && level === 1) || (level > settings.maxLevel)) {
            // Remove any heading numbers in these two cases:
            // 1. this is a top level and we are skipping top level headings
            // 2. this level is higher than the max level setting
            /* This would allow skipped headings to be stripped of their numbering, but this makes it difficult to truly skip a heading
            const prefixRange = getHeadingPrefixRange(editor, heading)
      
            if (prefixRange) {
              const headingHashString = makeHeadingHashString(editor, heading)
              if (headingHashString === undefined) continue
              replaceRangeSafely(editor, changes, prefixRange, headingHashString + ' ')
            }
            */
            continue;
        }
        // Adjust numbering stack
        if (level === previousLevel) {
            const x = numberingStack.pop();
            if (x !== undefined) {
                numberingStack.push(nextNumberingToken(x));
            }
        }
        else if (level < previousLevel) {
            for (let i = previousLevel; i > level; i--) {
                numberingStack.pop();
            }
            const x = numberingStack.pop();
            if (x !== undefined) {
                numberingStack.push(nextNumberingToken(x));
            }
        }
        else if (level > previousLevel) {
            for (let i = previousLevel; i < level; i++) {
                numberingStack.push(firstNumberingTokenInStyle(settings.styleLevelOther));
            }
        }
        // Set the previous level to this level for the next iteration
        previousLevel = level;
        if (level > settings.maxLevel) {
            // If we are above the max level, just don't number it
            continue;
        }
        // Find the range to replace, and then do it
        const prefixRange = getHeadingPrefixRange(editor, heading);
        if (prefixRange === undefined)
            return;
        const headingHashString = makeHeadingHashString(editor, heading);
        if (headingHashString === undefined)
            return;
        const prefixString = makeNumberingString(numberingStack);
        replaceRangeSafely(editor, changes, prefixRange, headingHashString + prefixString + settings.separator + ' ');
    }
    // Execute the transaction to make all the changes at once
    if (changes.length > 0) {
        // eslint-disable-next-line no-console
        console.log('Number Headings Plugin: Applying headings numbering changes:', changes.length);
        editor.transaction({
            changes: changes
        });
    }
};
const updateTableOfContents = (viewInfo, settings) => {
    var _a;
    if (!viewInfo)
        return;
    const headings = (_a = viewInfo.data.headings) !== null && _a !== void 0 ? _a : [];
    const editor = viewInfo.editor;
    if (!doesContentsHaveValue(settings.contents))
        return;
    let tocHeading;
    let tocBuilder = '\n';
    const changes = [];
    for (const heading of headings) {
        // ORDERING: Important to find the TOC heading before skipping skipped headings, since that is for numbering
        // Find the TOC heading
        if (heading.heading.endsWith(settings.contents)) {
            tocHeading = heading;
        }
        /* This code lets us skip TOC lines for skipped headings, but doesn't work well with first-level setting
        if ((settings.skipTopLevel && heading.level === 1) || (heading.level > settings.maxLevel)) {
          continue
        }
        */
        const tocEntry = createTocEntry(heading);
        tocBuilder += tocEntry + '\n';
    }
    // Insert the generated table of contents
    if (tocHeading) {
        const from = {
            line: tocHeading.position.start.line + 1,
            ch: 0
        };
        const startingLine = tocHeading.position.start.line + 1;
        let endingLine = 0;
        let foundList = false;
        for (endingLine = startingLine;; endingLine++) {
            const line = editor.getLine(endingLine);
            if (line === undefined) {
                // Reached end of file, insert at the start of the TOC section
                endingLine = startingLine;
                break;
            }
            const trimmedLineText = line.trimStart();
            if (foundList) {
                if (!trimmedLineText.startsWith(TOC_LIST_ITEM_BULLET))
                    break;
                if (trimmedLineText.startsWith('#'))
                    break;
            }
            else {
                if (trimmedLineText.startsWith(TOC_LIST_ITEM_BULLET)) {
                    foundList = true;
                }
                else if (trimmedLineText.startsWith('#')) {
                    // Reached the next heading without finding existing TOC list, insert at the start of the TOC section
                    endingLine = startingLine;
                    break;
                }
                else {
                    continue;
                }
            }
        }
        if (tocBuilder === '\n') {
            tocBuilder = '';
        }
        const to = {
            line: endingLine,
            ch: 0
        };
        const range = { from, to };
        replaceRangeSafely(editor, changes, range, tocBuilder);
    }
    // Execute the transaction to make all the changes at once
    if (changes.length > 0) {
        // eslint-disable-next-line no-console
        console.log('Number Headings Plugin: Applying table of contents changes:', changes.length);
        editor.transaction({
            changes: changes
        });
    }
};
const removeHeadingNumbering = (viewInfo) => {
    var _a;
    if (!viewInfo)
        return;
    const headings = (_a = viewInfo.data.headings) !== null && _a !== void 0 ? _a : [];
    const editor = viewInfo.editor;
    const changes = [];
    for (const heading of headings) {
        const prefixRange = getHeadingPrefixRange(editor, heading);
        if (prefixRange === undefined)
            return;
        const headingHashString = makeHeadingHashString(editor, heading);
        if (headingHashString === undefined)
            return;
        replaceRangeSafely(editor, changes, prefixRange, headingHashString + ' ');
    }
    if (changes.length > 0) {
        editor.transaction({
            changes: changes
        });
    }
};

class NumberHeadingsPluginSettingTab extends obsidian.PluginSettingTab {
    constructor(app, plugin) {
        super(app, plugin);
        this.plugin = plugin;
    }
    display() {
        const { containerEl } = this;
        containerEl.empty();
        containerEl.createEl('h2', { text: 'Number Headings - Settings' });
        containerEl.createEl('div', { text: 'To add numbering to your document, bring up the command window (on Mac, type CMD+P), and then type "Number Headings" to see a list of available commands.' });
        containerEl.createEl('br', {});
        containerEl.createEl('div', { text: 'If the document has front matter defined with the below settings, the project-wide settings defined on this screen will be ignored. You can define front matter like this:' });
        containerEl.createEl('pre', {
            text: `    ---
    alias:
    - Example Alias
    tags:
    - example-tag
    number headings: first-level 1, max 6, 1.1, auto, contents ^toc
    ---`
        });
        containerEl.createEl('div', {
            text: `
      The 'number headings' front matter key is used to store numbering settings specific to the file. There are four possible options
      in the value to the right of the colon, separated by commas.
    `
        });
        const ul = containerEl.createEl('ul', {});
        const li0 = ul.createEl('li', {});
        li0.createEl('b', { text: 'Automatic numbering' });
        li0.createEl('span', { text: ': If \'auto\' appears, the document will be automatically numbered.' });
        const li1 = ul.createEl('li', {});
        li1.createEl('b', { text: 'First level to number' });
        li1.createEl('span', { text: ': If \'first-level 2\' appears, the numbering will start at the second level' });
        const li2 = ul.createEl('li', {});
        li2.createEl('b', { text: 'Maximum level to number' });
        li2.createEl('span', { text: ': If \'max 6\' appears, the headings above level 6 will be skipped.' });
        const li3 = ul.createEl('li', {});
        li3.createEl('b', { text: 'Table of contents anchor' });
        li3.createEl('span', { text: ': If \'contents ^toc\' appears, the heading that ends with the anchor ^toc will have a table of contents inserted beneath it.' });
        const li4 = ul.createEl('li', {});
        li4.createEl('b', { text: 'Numbering style' });
        li4.createEl('span', {
            text: `:
      A style text like '1.1', 'A.1', or '_.1.1' tells the plugin how to format the headings.
      If a style string ends with '.' (a dot), ':' (a colon), or '-' (a dash), the heading numbers will be separated from the heading title
      with that symbol.`
        });
        const ul3 = li4.createEl('ul', {});
        ul3.createEl('li', {
            text: `      
      For example, '1.1' means both top level and other headings will be numbered starting from '1'.
    `
        });
        ul3.createEl('li', {
            text: `      
      For example, 'A.1' means top level headings will be numbered starting from 'A'.
    `
        });
        ul3.createEl('li', {
            text: `      
      For example, '_.A.1' means top level headings will NOT be numbered, but the next levels will be numbered with letters and numbers.
    `
        });
        ul3.createEl('li', {
            text: `      
      For example, '1.1:' means headings will look like '## 2.4: Example Heading'
    `
        });
        ul3.createEl('li', {
            text: `      
      For example, 'A.1-' means headings will look like '## B.5- Example Heading'
    `
        });
        new obsidian.Setting(containerEl)
            .setName('Skip top heading level')
            .setDesc('If selected, numbering will not be applied to the top heading level.')
            .addToggle(toggle => toggle
            .setValue(this.plugin.settings.skipTopLevel)
            .setTooltip('Skip top heading level')
            .onChange((value) => __awaiter(this, void 0, void 0, function* () {
            this.plugin.settings.skipTopLevel = value;
            yield this.plugin.saveSettings();
        })));
        new obsidian.Setting(containerEl)
            .setName('First heading level')
            .setDesc('First heading level to number.')
            .addSlider(slider => slider
            .setLimits(1, 6, 1)
            .setValue(this.plugin.settings.firstLevel)
            .setDynamicTooltip()
            .onChange((value) => __awaiter(this, void 0, void 0, function* () {
            this.plugin.settings.firstLevel = value;
            yield this.plugin.saveSettings();
        })));
        new obsidian.Setting(containerEl)
            .setName('Maximum heading level')
            .setDesc('Maximum heading level to number.')
            .addSlider(slider => slider
            .setLimits(1, 6, 1)
            .setValue(this.plugin.settings.maxLevel)
            .setDynamicTooltip()
            .onChange((value) => __awaiter(this, void 0, void 0, function* () {
            this.plugin.settings.maxLevel = value;
            yield this.plugin.saveSettings();
        })));
        new obsidian.Setting(containerEl)
            .setName('Style for level 1 headings')
            .setDesc('Defines the numbering style for level one headings. Valid values are 1 (for numbers) or A (for capital letters).')
            .addText(text => text
            .setValue(this.plugin.settings.styleLevel1)
            .onChange((value) => __awaiter(this, void 0, void 0, function* () {
            this.plugin.settings.styleLevel1 = value;
            yield this.plugin.saveSettings();
        })));
        new obsidian.Setting(containerEl)
            .setName('Style for lower level headings (below level 1)')
            .setDesc('Defines the numbering style for headings below level one. Valid values are 1 (for numbers) or A (for capital letters).')
            .addText(text => text
            .setValue(this.plugin.settings.styleLevelOther)
            .onChange((value) => __awaiter(this, void 0, void 0, function* () {
            this.plugin.settings.styleLevelOther = value;
            yield this.plugin.saveSettings();
        })));
        new obsidian.Setting(containerEl)
            .setName('Automatic numbering')
            .setDesc('Turns on automatic numbering of documents.')
            .addToggle(toggle => toggle
            .setValue(this.plugin.settings.auto)
            .setTooltip('Turn on automatic numbering')
            .onChange((value) => __awaiter(this, void 0, void 0, function* () {
            this.plugin.settings.auto = value;
            yield this.plugin.saveSettings();
        })));
        new obsidian.Setting(containerEl)
            .setName('Separator style')
            .setDesc('Defines the separator style between the heading number and the heading text. Valid values are : (colon) or . (dot) or - (dash). You can also leave it blank for no separator.')
            .addText(text => text
            .setValue(this.plugin.settings.separator)
            .onChange((value) => __awaiter(this, void 0, void 0, function* () {
            this.plugin.settings.separator = value;
            yield this.plugin.saveSettings();
        })));
        new obsidian.Setting(containerEl)
            .setName('Table of Contents Anchor')
            .setDesc('Anchor which labels the header where a table of contents should be inserted. The anchor should be added at the end of a header. For example, ^toc.')
            .addText(text => text
            .setValue(this.plugin.settings.contents)
            .onChange((value) => __awaiter(this, void 0, void 0, function* () {
            this.plugin.settings.contents = value;
            yield this.plugin.saveSettings();
        })));
    }
}
class NumberHeadingsPlugin extends obsidian.Plugin {
    onload() {
        return __awaiter(this, void 0, void 0, function* () {
            // eslint-disable-next-line no-console
            console.info('Loading Number Headings Plugin, version ' + this.manifest.version);
            yield this.loadSettings();
            this.addCommand({
                id: 'number-headings',
                name: 'Number all headings in document',
                checkCallback: (checking) => {
                    if (checking)
                        return isViewActive(this.app);
                    const viewInfo = getViewInfo(this.app);
                    if (viewInfo) {
                        const settings = getFrontMatterSettingsOrAlternative(viewInfo.data, this.settings);
                        updateHeadingNumbering(viewInfo, settings);
                        setTimeout(() => {
                            // HACK: This must happen after a timeout so that there is time for the editor transaction to complete
                            const postNumberingViewInfo = getViewInfo(this.app);
                            updateTableOfContents(postNumberingViewInfo, settings);
                        }, 3000);
                        const saveSettingsCallback = (shouldAddAutoFlag) => {
                            const tweakedSettings = Object.assign({}, settings);
                            if (shouldAddAutoFlag)
                                tweakedSettings.auto = true;
                            saveSettingsToFrontMatter(viewInfo.data, viewInfo.editor, tweakedSettings);
                        };
                        const config = {
                            message: `Successfully updated all heading numbers in the document, using the settings below. 
              See settings panel to change how headings are numbered, or use front matter
              (see settings panel).`,
                            preformattedMessage: `  Skip top heading level: ${settings.skipTopLevel}
  First heading level: ${settings.firstLevel}
  Maximum heading level: ${settings.maxLevel}
  Style for level 1 headings: ${settings.styleLevel1}
  Style for lower level headings (below level 1): ${settings.styleLevelOther}
  Separator: ${settings.separator}
  Table of Contents Anchor: ${settings.contents}`,
                            saveSettingsCallback
                        };
                        showNumberingDoneMessage(this.app, config);
                    }
                    return false;
                }
            });
            this.addCommand({
                id: 'remove-number-headings',
                name: 'Remove numbering from all headings in document',
                checkCallback: (checking) => {
                    if (checking)
                        return isViewActive(this.app);
                    const viewInfo = getViewInfo(this.app);
                    removeHeadingNumbering(viewInfo);
                    return true;
                }
            });
            this.addCommand({
                id: 'save-settings-to-front-matter',
                name: 'Save settings to front matter',
                checkCallback: (checking) => {
                    if (checking)
                        return isViewActive(this.app);
                    const viewInfo = getViewInfo(this.app);
                    if (viewInfo) {
                        const settings = getFrontMatterSettingsOrAlternative(viewInfo.data, this.settings);
                        saveSettingsToFrontMatter(viewInfo.data, viewInfo.editor, settings);
                    }
                    return false;
                }
            });
            this.addSettingTab(new NumberHeadingsPluginSettingTab(this.app, this));
            this.registerInterval(window.setInterval(() => {
                const viewInfo = getViewInfo(this.app);
                if (viewInfo) {
                    const settings = getFrontMatterSettingsOrAlternative(viewInfo.data, this.settings);
                    if (settings.auto) {
                        updateHeadingNumbering(viewInfo, settings);
                        setTimeout(() => {
                            // HACK: This must happen after a timeout so that there is time for the editor transaction to complete
                            const postNumberingViewInfo = getViewInfo(this.app);
                            updateTableOfContents(postNumberingViewInfo, settings);
                        }, 3000);
                        // eslint-disable-next-line no-console
                        console.log('Number Headings Plugin: Automatically numbered document');
                    }
                }
            }, 10 * 1000));
        });
    }
    loadSettings() {
        return __awaiter(this, void 0, void 0, function* () {
            this.settings = Object.assign({}, DEFAULT_SETTINGS, yield this.loadData());
        });
    }
    saveSettings() {
        return __awaiter(this, void 0, void 0, function* () {
            yield this.saveData(this.settings);
        });
    }
}

module.exports = NumberHeadingsPlugin;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibWFpbi5qcyIsInNvdXJjZXMiOlsibm9kZV9tb2R1bGVzL3RzbGliL3RzbGliLmVzNi5qcyIsInNyYy9hY3RpdmVWaWV3SGVscGVycy50cyIsInNyYy9zZXR0aW5nc1R5cGVzLnRzIiwic3JjL2Zyb250TWF0dGVyLnRzIiwic3JjL21lc3NhZ2VzLnRzIiwic3JjL251bWJlcmluZy50cyIsInNyYy9tYWluLnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qISAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKlxyXG5Db3B5cmlnaHQgKGMpIE1pY3Jvc29mdCBDb3Jwb3JhdGlvbi5cclxuXHJcblBlcm1pc3Npb24gdG8gdXNlLCBjb3B5LCBtb2RpZnksIGFuZC9vciBkaXN0cmlidXRlIHRoaXMgc29mdHdhcmUgZm9yIGFueVxyXG5wdXJwb3NlIHdpdGggb3Igd2l0aG91dCBmZWUgaXMgaGVyZWJ5IGdyYW50ZWQuXHJcblxyXG5USEUgU09GVFdBUkUgSVMgUFJPVklERUQgXCJBUyBJU1wiIEFORCBUSEUgQVVUSE9SIERJU0NMQUlNUyBBTEwgV0FSUkFOVElFUyBXSVRIXHJcblJFR0FSRCBUTyBUSElTIFNPRlRXQVJFIElOQ0xVRElORyBBTEwgSU1QTElFRCBXQVJSQU5USUVTIE9GIE1FUkNIQU5UQUJJTElUWVxyXG5BTkQgRklUTkVTUy4gSU4gTk8gRVZFTlQgU0hBTEwgVEhFIEFVVEhPUiBCRSBMSUFCTEUgRk9SIEFOWSBTUEVDSUFMLCBESVJFQ1QsXHJcbklORElSRUNULCBPUiBDT05TRVFVRU5USUFMIERBTUFHRVMgT1IgQU5ZIERBTUFHRVMgV0hBVFNPRVZFUiBSRVNVTFRJTkcgRlJPTVxyXG5MT1NTIE9GIFVTRSwgREFUQSBPUiBQUk9GSVRTLCBXSEVUSEVSIElOIEFOIEFDVElPTiBPRiBDT05UUkFDVCwgTkVHTElHRU5DRSBPUlxyXG5PVEhFUiBUT1JUSU9VUyBBQ1RJT04sIEFSSVNJTkcgT1VUIE9GIE9SIElOIENPTk5FQ1RJT04gV0lUSCBUSEUgVVNFIE9SXHJcblBFUkZPUk1BTkNFIE9GIFRISVMgU09GVFdBUkUuXHJcbioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqICovXHJcbi8qIGdsb2JhbCBSZWZsZWN0LCBQcm9taXNlICovXHJcblxyXG52YXIgZXh0ZW5kU3RhdGljcyA9IGZ1bmN0aW9uKGQsIGIpIHtcclxuICAgIGV4dGVuZFN0YXRpY3MgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgfHxcclxuICAgICAgICAoeyBfX3Byb3RvX186IFtdIH0gaW5zdGFuY2VvZiBBcnJheSAmJiBmdW5jdGlvbiAoZCwgYikgeyBkLl9fcHJvdG9fXyA9IGI7IH0pIHx8XHJcbiAgICAgICAgZnVuY3Rpb24gKGQsIGIpIHsgZm9yICh2YXIgcCBpbiBiKSBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKGIsIHApKSBkW3BdID0gYltwXTsgfTtcclxuICAgIHJldHVybiBleHRlbmRTdGF0aWNzKGQsIGIpO1xyXG59O1xyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fZXh0ZW5kcyhkLCBiKSB7XHJcbiAgICBpZiAodHlwZW9mIGIgIT09IFwiZnVuY3Rpb25cIiAmJiBiICE9PSBudWxsKVxyXG4gICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoXCJDbGFzcyBleHRlbmRzIHZhbHVlIFwiICsgU3RyaW5nKGIpICsgXCIgaXMgbm90IGEgY29uc3RydWN0b3Igb3IgbnVsbFwiKTtcclxuICAgIGV4dGVuZFN0YXRpY3MoZCwgYik7XHJcbiAgICBmdW5jdGlvbiBfXygpIHsgdGhpcy5jb25zdHJ1Y3RvciA9IGQ7IH1cclxuICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTtcclxufVxyXG5cclxuZXhwb3J0IHZhciBfX2Fzc2lnbiA9IGZ1bmN0aW9uKCkge1xyXG4gICAgX19hc3NpZ24gPSBPYmplY3QuYXNzaWduIHx8IGZ1bmN0aW9uIF9fYXNzaWduKHQpIHtcclxuICAgICAgICBmb3IgKHZhciBzLCBpID0gMSwgbiA9IGFyZ3VtZW50cy5sZW5ndGg7IGkgPCBuOyBpKyspIHtcclxuICAgICAgICAgICAgcyA9IGFyZ3VtZW50c1tpXTtcclxuICAgICAgICAgICAgZm9yICh2YXIgcCBpbiBzKSBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKHMsIHApKSB0W3BdID0gc1twXTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHQ7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gX19hc3NpZ24uYXBwbHkodGhpcywgYXJndW1lbnRzKTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fcmVzdChzLCBlKSB7XHJcbiAgICB2YXIgdCA9IHt9O1xyXG4gICAgZm9yICh2YXIgcCBpbiBzKSBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKHMsIHApICYmIGUuaW5kZXhPZihwKSA8IDApXHJcbiAgICAgICAgdFtwXSA9IHNbcF07XHJcbiAgICBpZiAocyAhPSBudWxsICYmIHR5cGVvZiBPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzID09PSBcImZ1bmN0aW9uXCIpXHJcbiAgICAgICAgZm9yICh2YXIgaSA9IDAsIHAgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKHMpOyBpIDwgcC5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICBpZiAoZS5pbmRleE9mKHBbaV0pIDwgMCAmJiBPYmplY3QucHJvdG90eXBlLnByb3BlcnR5SXNFbnVtZXJhYmxlLmNhbGwocywgcFtpXSkpXHJcbiAgICAgICAgICAgICAgICB0W3BbaV1dID0gc1twW2ldXTtcclxuICAgICAgICB9XHJcbiAgICByZXR1cm4gdDtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fZGVjb3JhdGUoZGVjb3JhdG9ycywgdGFyZ2V0LCBrZXksIGRlc2MpIHtcclxuICAgIHZhciBjID0gYXJndW1lbnRzLmxlbmd0aCwgciA9IGMgPCAzID8gdGFyZ2V0IDogZGVzYyA9PT0gbnVsbCA/IGRlc2MgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKHRhcmdldCwga2V5KSA6IGRlc2MsIGQ7XHJcbiAgICBpZiAodHlwZW9mIFJlZmxlY3QgPT09IFwib2JqZWN0XCIgJiYgdHlwZW9mIFJlZmxlY3QuZGVjb3JhdGUgPT09IFwiZnVuY3Rpb25cIikgciA9IFJlZmxlY3QuZGVjb3JhdGUoZGVjb3JhdG9ycywgdGFyZ2V0LCBrZXksIGRlc2MpO1xyXG4gICAgZWxzZSBmb3IgKHZhciBpID0gZGVjb3JhdG9ycy5sZW5ndGggLSAxOyBpID49IDA7IGktLSkgaWYgKGQgPSBkZWNvcmF0b3JzW2ldKSByID0gKGMgPCAzID8gZChyKSA6IGMgPiAzID8gZCh0YXJnZXQsIGtleSwgcikgOiBkKHRhcmdldCwga2V5KSkgfHwgcjtcclxuICAgIHJldHVybiBjID4gMyAmJiByICYmIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGtleSwgciksIHI7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX3BhcmFtKHBhcmFtSW5kZXgsIGRlY29yYXRvcikge1xyXG4gICAgcmV0dXJuIGZ1bmN0aW9uICh0YXJnZXQsIGtleSkgeyBkZWNvcmF0b3IodGFyZ2V0LCBrZXksIHBhcmFtSW5kZXgpOyB9XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX21ldGFkYXRhKG1ldGFkYXRhS2V5LCBtZXRhZGF0YVZhbHVlKSB7XHJcbiAgICBpZiAodHlwZW9mIFJlZmxlY3QgPT09IFwib2JqZWN0XCIgJiYgdHlwZW9mIFJlZmxlY3QubWV0YWRhdGEgPT09IFwiZnVuY3Rpb25cIikgcmV0dXJuIFJlZmxlY3QubWV0YWRhdGEobWV0YWRhdGFLZXksIG1ldGFkYXRhVmFsdWUpO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19hd2FpdGVyKHRoaXNBcmcsIF9hcmd1bWVudHMsIFAsIGdlbmVyYXRvcikge1xyXG4gICAgZnVuY3Rpb24gYWRvcHQodmFsdWUpIHsgcmV0dXJuIHZhbHVlIGluc3RhbmNlb2YgUCA/IHZhbHVlIDogbmV3IFAoZnVuY3Rpb24gKHJlc29sdmUpIHsgcmVzb2x2ZSh2YWx1ZSk7IH0pOyB9XHJcbiAgICByZXR1cm4gbmV3IChQIHx8IChQID0gUHJvbWlzZSkpKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcclxuICAgICAgICBmdW5jdGlvbiBmdWxmaWxsZWQodmFsdWUpIHsgdHJ5IHsgc3RlcChnZW5lcmF0b3IubmV4dCh2YWx1ZSkpOyB9IGNhdGNoIChlKSB7IHJlamVjdChlKTsgfSB9XHJcbiAgICAgICAgZnVuY3Rpb24gcmVqZWN0ZWQodmFsdWUpIHsgdHJ5IHsgc3RlcChnZW5lcmF0b3JbXCJ0aHJvd1wiXSh2YWx1ZSkpOyB9IGNhdGNoIChlKSB7IHJlamVjdChlKTsgfSB9XHJcbiAgICAgICAgZnVuY3Rpb24gc3RlcChyZXN1bHQpIHsgcmVzdWx0LmRvbmUgPyByZXNvbHZlKHJlc3VsdC52YWx1ZSkgOiBhZG9wdChyZXN1bHQudmFsdWUpLnRoZW4oZnVsZmlsbGVkLCByZWplY3RlZCk7IH1cclxuICAgICAgICBzdGVwKChnZW5lcmF0b3IgPSBnZW5lcmF0b3IuYXBwbHkodGhpc0FyZywgX2FyZ3VtZW50cyB8fCBbXSkpLm5leHQoKSk7XHJcbiAgICB9KTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fZ2VuZXJhdG9yKHRoaXNBcmcsIGJvZHkpIHtcclxuICAgIHZhciBfID0geyBsYWJlbDogMCwgc2VudDogZnVuY3Rpb24oKSB7IGlmICh0WzBdICYgMSkgdGhyb3cgdFsxXTsgcmV0dXJuIHRbMV07IH0sIHRyeXM6IFtdLCBvcHM6IFtdIH0sIGYsIHksIHQsIGc7XHJcbiAgICByZXR1cm4gZyA9IHsgbmV4dDogdmVyYigwKSwgXCJ0aHJvd1wiOiB2ZXJiKDEpLCBcInJldHVyblwiOiB2ZXJiKDIpIH0sIHR5cGVvZiBTeW1ib2wgPT09IFwiZnVuY3Rpb25cIiAmJiAoZ1tTeW1ib2wuaXRlcmF0b3JdID0gZnVuY3Rpb24oKSB7IHJldHVybiB0aGlzOyB9KSwgZztcclxuICAgIGZ1bmN0aW9uIHZlcmIobikgeyByZXR1cm4gZnVuY3Rpb24gKHYpIHsgcmV0dXJuIHN0ZXAoW24sIHZdKTsgfTsgfVxyXG4gICAgZnVuY3Rpb24gc3RlcChvcCkge1xyXG4gICAgICAgIGlmIChmKSB0aHJvdyBuZXcgVHlwZUVycm9yKFwiR2VuZXJhdG9yIGlzIGFscmVhZHkgZXhlY3V0aW5nLlwiKTtcclxuICAgICAgICB3aGlsZSAoXykgdHJ5IHtcclxuICAgICAgICAgICAgaWYgKGYgPSAxLCB5ICYmICh0ID0gb3BbMF0gJiAyID8geVtcInJldHVyblwiXSA6IG9wWzBdID8geVtcInRocm93XCJdIHx8ICgodCA9IHlbXCJyZXR1cm5cIl0pICYmIHQuY2FsbCh5KSwgMCkgOiB5Lm5leHQpICYmICEodCA9IHQuY2FsbCh5LCBvcFsxXSkpLmRvbmUpIHJldHVybiB0O1xyXG4gICAgICAgICAgICBpZiAoeSA9IDAsIHQpIG9wID0gW29wWzBdICYgMiwgdC52YWx1ZV07XHJcbiAgICAgICAgICAgIHN3aXRjaCAob3BbMF0pIHtcclxuICAgICAgICAgICAgICAgIGNhc2UgMDogY2FzZSAxOiB0ID0gb3A7IGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgY2FzZSA0OiBfLmxhYmVsKys7IHJldHVybiB7IHZhbHVlOiBvcFsxXSwgZG9uZTogZmFsc2UgfTtcclxuICAgICAgICAgICAgICAgIGNhc2UgNTogXy5sYWJlbCsrOyB5ID0gb3BbMV07IG9wID0gWzBdOyBjb250aW51ZTtcclxuICAgICAgICAgICAgICAgIGNhc2UgNzogb3AgPSBfLm9wcy5wb3AoKTsgXy50cnlzLnBvcCgpOyBjb250aW51ZTtcclxuICAgICAgICAgICAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKCEodCA9IF8udHJ5cywgdCA9IHQubGVuZ3RoID4gMCAmJiB0W3QubGVuZ3RoIC0gMV0pICYmIChvcFswXSA9PT0gNiB8fCBvcFswXSA9PT0gMikpIHsgXyA9IDA7IGNvbnRpbnVlOyB9XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKG9wWzBdID09PSAzICYmICghdCB8fCAob3BbMV0gPiB0WzBdICYmIG9wWzFdIDwgdFszXSkpKSB7IF8ubGFiZWwgPSBvcFsxXTsgYnJlYWs7IH1cclxuICAgICAgICAgICAgICAgICAgICBpZiAob3BbMF0gPT09IDYgJiYgXy5sYWJlbCA8IHRbMV0pIHsgXy5sYWJlbCA9IHRbMV07IHQgPSBvcDsgYnJlYWs7IH1cclxuICAgICAgICAgICAgICAgICAgICBpZiAodCAmJiBfLmxhYmVsIDwgdFsyXSkgeyBfLmxhYmVsID0gdFsyXTsgXy5vcHMucHVzaChvcCk7IGJyZWFrOyB9XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRbMl0pIF8ub3BzLnBvcCgpO1xyXG4gICAgICAgICAgICAgICAgICAgIF8udHJ5cy5wb3AoKTsgY29udGludWU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgb3AgPSBib2R5LmNhbGwodGhpc0FyZywgXyk7XHJcbiAgICAgICAgfSBjYXRjaCAoZSkgeyBvcCA9IFs2LCBlXTsgeSA9IDA7IH0gZmluYWxseSB7IGYgPSB0ID0gMDsgfVxyXG4gICAgICAgIGlmIChvcFswXSAmIDUpIHRocm93IG9wWzFdOyByZXR1cm4geyB2YWx1ZTogb3BbMF0gPyBvcFsxXSA6IHZvaWQgMCwgZG9uZTogdHJ1ZSB9O1xyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgdmFyIF9fY3JlYXRlQmluZGluZyA9IE9iamVjdC5jcmVhdGUgPyAoZnVuY3Rpb24obywgbSwgaywgazIpIHtcclxuICAgIGlmIChrMiA9PT0gdW5kZWZpbmVkKSBrMiA9IGs7XHJcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkobywgazIsIHsgZW51bWVyYWJsZTogdHJ1ZSwgZ2V0OiBmdW5jdGlvbigpIHsgcmV0dXJuIG1ba107IH0gfSk7XHJcbn0pIDogKGZ1bmN0aW9uKG8sIG0sIGssIGsyKSB7XHJcbiAgICBpZiAoazIgPT09IHVuZGVmaW5lZCkgazIgPSBrO1xyXG4gICAgb1trMl0gPSBtW2tdO1xyXG59KTtcclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2V4cG9ydFN0YXIobSwgbykge1xyXG4gICAgZm9yICh2YXIgcCBpbiBtKSBpZiAocCAhPT0gXCJkZWZhdWx0XCIgJiYgIU9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvLCBwKSkgX19jcmVhdGVCaW5kaW5nKG8sIG0sIHApO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX192YWx1ZXMobykge1xyXG4gICAgdmFyIHMgPSB0eXBlb2YgU3ltYm9sID09PSBcImZ1bmN0aW9uXCIgJiYgU3ltYm9sLml0ZXJhdG9yLCBtID0gcyAmJiBvW3NdLCBpID0gMDtcclxuICAgIGlmIChtKSByZXR1cm4gbS5jYWxsKG8pO1xyXG4gICAgaWYgKG8gJiYgdHlwZW9mIG8ubGVuZ3RoID09PSBcIm51bWJlclwiKSByZXR1cm4ge1xyXG4gICAgICAgIG5leHQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgaWYgKG8gJiYgaSA+PSBvLmxlbmd0aCkgbyA9IHZvaWQgMDtcclxuICAgICAgICAgICAgcmV0dXJuIHsgdmFsdWU6IG8gJiYgb1tpKytdLCBkb25lOiAhbyB9O1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICB0aHJvdyBuZXcgVHlwZUVycm9yKHMgPyBcIk9iamVjdCBpcyBub3QgaXRlcmFibGUuXCIgOiBcIlN5bWJvbC5pdGVyYXRvciBpcyBub3QgZGVmaW5lZC5cIik7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX3JlYWQobywgbikge1xyXG4gICAgdmFyIG0gPSB0eXBlb2YgU3ltYm9sID09PSBcImZ1bmN0aW9uXCIgJiYgb1tTeW1ib2wuaXRlcmF0b3JdO1xyXG4gICAgaWYgKCFtKSByZXR1cm4gbztcclxuICAgIHZhciBpID0gbS5jYWxsKG8pLCByLCBhciA9IFtdLCBlO1xyXG4gICAgdHJ5IHtcclxuICAgICAgICB3aGlsZSAoKG4gPT09IHZvaWQgMCB8fCBuLS0gPiAwKSAmJiAhKHIgPSBpLm5leHQoKSkuZG9uZSkgYXIucHVzaChyLnZhbHVlKTtcclxuICAgIH1cclxuICAgIGNhdGNoIChlcnJvcikgeyBlID0geyBlcnJvcjogZXJyb3IgfTsgfVxyXG4gICAgZmluYWxseSB7XHJcbiAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgaWYgKHIgJiYgIXIuZG9uZSAmJiAobSA9IGlbXCJyZXR1cm5cIl0pKSBtLmNhbGwoaSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGZpbmFsbHkgeyBpZiAoZSkgdGhyb3cgZS5lcnJvcjsgfVxyXG4gICAgfVxyXG4gICAgcmV0dXJuIGFyO1xyXG59XHJcblxyXG4vKiogQGRlcHJlY2F0ZWQgKi9cclxuZXhwb3J0IGZ1bmN0aW9uIF9fc3ByZWFkKCkge1xyXG4gICAgZm9yICh2YXIgYXIgPSBbXSwgaSA9IDA7IGkgPCBhcmd1bWVudHMubGVuZ3RoOyBpKyspXHJcbiAgICAgICAgYXIgPSBhci5jb25jYXQoX19yZWFkKGFyZ3VtZW50c1tpXSkpO1xyXG4gICAgcmV0dXJuIGFyO1xyXG59XHJcblxyXG4vKiogQGRlcHJlY2F0ZWQgKi9cclxuZXhwb3J0IGZ1bmN0aW9uIF9fc3ByZWFkQXJyYXlzKCkge1xyXG4gICAgZm9yICh2YXIgcyA9IDAsIGkgPSAwLCBpbCA9IGFyZ3VtZW50cy5sZW5ndGg7IGkgPCBpbDsgaSsrKSBzICs9IGFyZ3VtZW50c1tpXS5sZW5ndGg7XHJcbiAgICBmb3IgKHZhciByID0gQXJyYXkocyksIGsgPSAwLCBpID0gMDsgaSA8IGlsOyBpKyspXHJcbiAgICAgICAgZm9yICh2YXIgYSA9IGFyZ3VtZW50c1tpXSwgaiA9IDAsIGpsID0gYS5sZW5ndGg7IGogPCBqbDsgaisrLCBrKyspXHJcbiAgICAgICAgICAgIHJba10gPSBhW2pdO1xyXG4gICAgcmV0dXJuIHI7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX3NwcmVhZEFycmF5KHRvLCBmcm9tLCBwYWNrKSB7XHJcbiAgICBpZiAocGFjayB8fCBhcmd1bWVudHMubGVuZ3RoID09PSAyKSBmb3IgKHZhciBpID0gMCwgbCA9IGZyb20ubGVuZ3RoLCBhcjsgaSA8IGw7IGkrKykge1xyXG4gICAgICAgIGlmIChhciB8fCAhKGkgaW4gZnJvbSkpIHtcclxuICAgICAgICAgICAgaWYgKCFhcikgYXIgPSBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChmcm9tLCAwLCBpKTtcclxuICAgICAgICAgICAgYXJbaV0gPSBmcm9tW2ldO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIHJldHVybiB0by5jb25jYXQoYXIgfHwgQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoZnJvbSkpO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19hd2FpdCh2KSB7XHJcbiAgICByZXR1cm4gdGhpcyBpbnN0YW5jZW9mIF9fYXdhaXQgPyAodGhpcy52ID0gdiwgdGhpcykgOiBuZXcgX19hd2FpdCh2KTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fYXN5bmNHZW5lcmF0b3IodGhpc0FyZywgX2FyZ3VtZW50cywgZ2VuZXJhdG9yKSB7XHJcbiAgICBpZiAoIVN5bWJvbC5hc3luY0l0ZXJhdG9yKSB0aHJvdyBuZXcgVHlwZUVycm9yKFwiU3ltYm9sLmFzeW5jSXRlcmF0b3IgaXMgbm90IGRlZmluZWQuXCIpO1xyXG4gICAgdmFyIGcgPSBnZW5lcmF0b3IuYXBwbHkodGhpc0FyZywgX2FyZ3VtZW50cyB8fCBbXSksIGksIHEgPSBbXTtcclxuICAgIHJldHVybiBpID0ge30sIHZlcmIoXCJuZXh0XCIpLCB2ZXJiKFwidGhyb3dcIiksIHZlcmIoXCJyZXR1cm5cIiksIGlbU3ltYm9sLmFzeW5jSXRlcmF0b3JdID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gdGhpczsgfSwgaTtcclxuICAgIGZ1bmN0aW9uIHZlcmIobikgeyBpZiAoZ1tuXSkgaVtuXSA9IGZ1bmN0aW9uICh2KSB7IHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAoYSwgYikgeyBxLnB1c2goW24sIHYsIGEsIGJdKSA+IDEgfHwgcmVzdW1lKG4sIHYpOyB9KTsgfTsgfVxyXG4gICAgZnVuY3Rpb24gcmVzdW1lKG4sIHYpIHsgdHJ5IHsgc3RlcChnW25dKHYpKTsgfSBjYXRjaCAoZSkgeyBzZXR0bGUocVswXVszXSwgZSk7IH0gfVxyXG4gICAgZnVuY3Rpb24gc3RlcChyKSB7IHIudmFsdWUgaW5zdGFuY2VvZiBfX2F3YWl0ID8gUHJvbWlzZS5yZXNvbHZlKHIudmFsdWUudikudGhlbihmdWxmaWxsLCByZWplY3QpIDogc2V0dGxlKHFbMF1bMl0sIHIpOyB9XHJcbiAgICBmdW5jdGlvbiBmdWxmaWxsKHZhbHVlKSB7IHJlc3VtZShcIm5leHRcIiwgdmFsdWUpOyB9XHJcbiAgICBmdW5jdGlvbiByZWplY3QodmFsdWUpIHsgcmVzdW1lKFwidGhyb3dcIiwgdmFsdWUpOyB9XHJcbiAgICBmdW5jdGlvbiBzZXR0bGUoZiwgdikgeyBpZiAoZih2KSwgcS5zaGlmdCgpLCBxLmxlbmd0aCkgcmVzdW1lKHFbMF1bMF0sIHFbMF1bMV0pOyB9XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2FzeW5jRGVsZWdhdG9yKG8pIHtcclxuICAgIHZhciBpLCBwO1xyXG4gICAgcmV0dXJuIGkgPSB7fSwgdmVyYihcIm5leHRcIiksIHZlcmIoXCJ0aHJvd1wiLCBmdW5jdGlvbiAoZSkgeyB0aHJvdyBlOyB9KSwgdmVyYihcInJldHVyblwiKSwgaVtTeW1ib2wuaXRlcmF0b3JdID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gdGhpczsgfSwgaTtcclxuICAgIGZ1bmN0aW9uIHZlcmIobiwgZikgeyBpW25dID0gb1tuXSA/IGZ1bmN0aW9uICh2KSB7IHJldHVybiAocCA9ICFwKSA/IHsgdmFsdWU6IF9fYXdhaXQob1tuXSh2KSksIGRvbmU6IG4gPT09IFwicmV0dXJuXCIgfSA6IGYgPyBmKHYpIDogdjsgfSA6IGY7IH1cclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fYXN5bmNWYWx1ZXMobykge1xyXG4gICAgaWYgKCFTeW1ib2wuYXN5bmNJdGVyYXRvcikgdGhyb3cgbmV3IFR5cGVFcnJvcihcIlN5bWJvbC5hc3luY0l0ZXJhdG9yIGlzIG5vdCBkZWZpbmVkLlwiKTtcclxuICAgIHZhciBtID0gb1tTeW1ib2wuYXN5bmNJdGVyYXRvcl0sIGk7XHJcbiAgICByZXR1cm4gbSA/IG0uY2FsbChvKSA6IChvID0gdHlwZW9mIF9fdmFsdWVzID09PSBcImZ1bmN0aW9uXCIgPyBfX3ZhbHVlcyhvKSA6IG9bU3ltYm9sLml0ZXJhdG9yXSgpLCBpID0ge30sIHZlcmIoXCJuZXh0XCIpLCB2ZXJiKFwidGhyb3dcIiksIHZlcmIoXCJyZXR1cm5cIiksIGlbU3ltYm9sLmFzeW5jSXRlcmF0b3JdID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gdGhpczsgfSwgaSk7XHJcbiAgICBmdW5jdGlvbiB2ZXJiKG4pIHsgaVtuXSA9IG9bbl0gJiYgZnVuY3Rpb24gKHYpIHsgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHsgdiA9IG9bbl0odiksIHNldHRsZShyZXNvbHZlLCByZWplY3QsIHYuZG9uZSwgdi52YWx1ZSk7IH0pOyB9OyB9XHJcbiAgICBmdW5jdGlvbiBzZXR0bGUocmVzb2x2ZSwgcmVqZWN0LCBkLCB2KSB7IFByb21pc2UucmVzb2x2ZSh2KS50aGVuKGZ1bmN0aW9uKHYpIHsgcmVzb2x2ZSh7IHZhbHVlOiB2LCBkb25lOiBkIH0pOyB9LCByZWplY3QpOyB9XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX21ha2VUZW1wbGF0ZU9iamVjdChjb29rZWQsIHJhdykge1xyXG4gICAgaWYgKE9iamVjdC5kZWZpbmVQcm9wZXJ0eSkgeyBPYmplY3QuZGVmaW5lUHJvcGVydHkoY29va2VkLCBcInJhd1wiLCB7IHZhbHVlOiByYXcgfSk7IH0gZWxzZSB7IGNvb2tlZC5yYXcgPSByYXc7IH1cclxuICAgIHJldHVybiBjb29rZWQ7XHJcbn07XHJcblxyXG52YXIgX19zZXRNb2R1bGVEZWZhdWx0ID0gT2JqZWN0LmNyZWF0ZSA/IChmdW5jdGlvbihvLCB2KSB7XHJcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkobywgXCJkZWZhdWx0XCIsIHsgZW51bWVyYWJsZTogdHJ1ZSwgdmFsdWU6IHYgfSk7XHJcbn0pIDogZnVuY3Rpb24obywgdikge1xyXG4gICAgb1tcImRlZmF1bHRcIl0gPSB2O1xyXG59O1xyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9faW1wb3J0U3Rhcihtb2QpIHtcclxuICAgIGlmIChtb2QgJiYgbW9kLl9fZXNNb2R1bGUpIHJldHVybiBtb2Q7XHJcbiAgICB2YXIgcmVzdWx0ID0ge307XHJcbiAgICBpZiAobW9kICE9IG51bGwpIGZvciAodmFyIGsgaW4gbW9kKSBpZiAoayAhPT0gXCJkZWZhdWx0XCIgJiYgT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG1vZCwgaykpIF9fY3JlYXRlQmluZGluZyhyZXN1bHQsIG1vZCwgayk7XHJcbiAgICBfX3NldE1vZHVsZURlZmF1bHQocmVzdWx0LCBtb2QpO1xyXG4gICAgcmV0dXJuIHJlc3VsdDtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9faW1wb3J0RGVmYXVsdChtb2QpIHtcclxuICAgIHJldHVybiAobW9kICYmIG1vZC5fX2VzTW9kdWxlKSA/IG1vZCA6IHsgZGVmYXVsdDogbW9kIH07XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2NsYXNzUHJpdmF0ZUZpZWxkR2V0KHJlY2VpdmVyLCBzdGF0ZSwga2luZCwgZikge1xyXG4gICAgaWYgKGtpbmQgPT09IFwiYVwiICYmICFmKSB0aHJvdyBuZXcgVHlwZUVycm9yKFwiUHJpdmF0ZSBhY2Nlc3NvciB3YXMgZGVmaW5lZCB3aXRob3V0IGEgZ2V0dGVyXCIpO1xyXG4gICAgaWYgKHR5cGVvZiBzdGF0ZSA9PT0gXCJmdW5jdGlvblwiID8gcmVjZWl2ZXIgIT09IHN0YXRlIHx8ICFmIDogIXN0YXRlLmhhcyhyZWNlaXZlcikpIHRocm93IG5ldyBUeXBlRXJyb3IoXCJDYW5ub3QgcmVhZCBwcml2YXRlIG1lbWJlciBmcm9tIGFuIG9iamVjdCB3aG9zZSBjbGFzcyBkaWQgbm90IGRlY2xhcmUgaXRcIik7XHJcbiAgICByZXR1cm4ga2luZCA9PT0gXCJtXCIgPyBmIDoga2luZCA9PT0gXCJhXCIgPyBmLmNhbGwocmVjZWl2ZXIpIDogZiA/IGYudmFsdWUgOiBzdGF0ZS5nZXQocmVjZWl2ZXIpO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19jbGFzc1ByaXZhdGVGaWVsZFNldChyZWNlaXZlciwgc3RhdGUsIHZhbHVlLCBraW5kLCBmKSB7XHJcbiAgICBpZiAoa2luZCA9PT0gXCJtXCIpIHRocm93IG5ldyBUeXBlRXJyb3IoXCJQcml2YXRlIG1ldGhvZCBpcyBub3Qgd3JpdGFibGVcIik7XHJcbiAgICBpZiAoa2luZCA9PT0gXCJhXCIgJiYgIWYpIHRocm93IG5ldyBUeXBlRXJyb3IoXCJQcml2YXRlIGFjY2Vzc29yIHdhcyBkZWZpbmVkIHdpdGhvdXQgYSBzZXR0ZXJcIik7XHJcbiAgICBpZiAodHlwZW9mIHN0YXRlID09PSBcImZ1bmN0aW9uXCIgPyByZWNlaXZlciAhPT0gc3RhdGUgfHwgIWYgOiAhc3RhdGUuaGFzKHJlY2VpdmVyKSkgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNhbm5vdCB3cml0ZSBwcml2YXRlIG1lbWJlciB0byBhbiBvYmplY3Qgd2hvc2UgY2xhc3MgZGlkIG5vdCBkZWNsYXJlIGl0XCIpO1xyXG4gICAgcmV0dXJuIChraW5kID09PSBcImFcIiA/IGYuY2FsbChyZWNlaXZlciwgdmFsdWUpIDogZiA/IGYudmFsdWUgPSB2YWx1ZSA6IHN0YXRlLnNldChyZWNlaXZlciwgdmFsdWUpKSwgdmFsdWU7XHJcbn1cclxuIiwiaW1wb3J0IHsgQXBwLCBDYWNoZWRNZXRhZGF0YSwgRWRpdG9yLCBNYXJrZG93blZpZXcgfSBmcm9tICdvYnNpZGlhbidcblxuZnVuY3Rpb24gZ2V0QWN0aXZlVmlldyAoYXBwOiBBcHApOiBNYXJrZG93blZpZXcgfCB1bmRlZmluZWQge1xuICBjb25zdCBhY3RpdmVWaWV3ID0gYXBwLndvcmtzcGFjZS5nZXRBY3RpdmVWaWV3T2ZUeXBlKE1hcmtkb3duVmlldylcbiAgcmV0dXJuIGFjdGl2ZVZpZXcgPz8gdW5kZWZpbmVkXG59XG5cbmV4cG9ydCBmdW5jdGlvbiBpc1ZpZXdBY3RpdmUgKGFwcDogQXBwKTogYm9vbGVhbiB7XG4gIGNvbnN0IGFjdGl2ZVZpZXcgPSBnZXRBY3RpdmVWaWV3KGFwcClcbiAgaWYgKGFjdGl2ZVZpZXcgJiYgYWN0aXZlVmlldy5maWxlKSByZXR1cm4gdHJ1ZVxuICByZXR1cm4gZmFsc2Vcbn1cblxuZnVuY3Rpb24gZ2V0Vmlld01ldGFkYXRhIChhcHA6IEFwcCk6IENhY2hlZE1ldGFkYXRhIHwgdW5kZWZpbmVkIHtcbiAgY29uc3QgYWN0aXZlVmlldyA9IGdldEFjdGl2ZVZpZXcoYXBwKVxuICBpZiAoYWN0aXZlVmlldyAmJiBhY3RpdmVWaWV3LmZpbGUpIHtcbiAgICBjb25zdCBkYXRhID0gYXBwLm1ldGFkYXRhQ2FjaGUuZ2V0RmlsZUNhY2hlKGFjdGl2ZVZpZXcuZmlsZSkgfHwge31cbiAgICByZXR1cm4gZGF0YVxuICB9XG4gIHJldHVybiB1bmRlZmluZWRcbn1cblxuZXhwb3J0IGludGVyZmFjZSBWaWV3SW5mbyB7XG4gIGFjdGl2ZVZpZXc6IE1hcmtkb3duVmlld1xuICBkYXRhOiBDYWNoZWRNZXRhZGF0YVxuICBlZGl0b3I6IEVkaXRvclxufVxuXG5leHBvcnQgZnVuY3Rpb24gZ2V0Vmlld0luZm8gKGFwcDogQXBwKTogVmlld0luZm8gfCB1bmRlZmluZWQge1xuICBjb25zdCBhY3RpdmVWaWV3ID0gZ2V0QWN0aXZlVmlldyhhcHApXG4gIGNvbnN0IGRhdGEgPSBnZXRWaWV3TWV0YWRhdGEoYXBwKVxuICBjb25zdCBlZGl0b3IgPSBhY3RpdmVWaWV3ID8gYWN0aXZlVmlldy5lZGl0b3IgOiB1bmRlZmluZWRcblxuICBpZiAoYWN0aXZlVmlldyAmJiBkYXRhICYmIGVkaXRvcikge1xuICAgIHJldHVybiB7XG4gICAgICBhY3RpdmVWaWV3LCBkYXRhLCBlZGl0b3JcbiAgICB9XG4gIH1cblxuICByZXR1cm4gdW5kZWZpbmVkXG59XG4iLCJleHBvcnQgaW50ZXJmYWNlIE51bWJlckhlYWRpbmdzUGx1Z2luU2V0dGluZ3Mge1xuICBza2lwVG9wTGV2ZWw6IGJvb2xlYW4sXG4gIGZpcnN0TGV2ZWw6IG51bWJlcixcbiAgbWF4TGV2ZWw6IG51bWJlcixcbiAgc3R5bGVMZXZlbDE6IHN0cmluZyxcbiAgc3R5bGVMZXZlbE90aGVyOiBzdHJpbmcsXG4gIGF1dG86IGJvb2xlYW4sXG4gIHNlcGFyYXRvcjogc3RyaW5nLFxuICBjb250ZW50czogc3RyaW5nXG59XG5cbmV4cG9ydCBjb25zdCBERUZBVUxUX1NFVFRJTkdTOiBOdW1iZXJIZWFkaW5nc1BsdWdpblNldHRpbmdzID0ge1xuICBza2lwVG9wTGV2ZWw6IGZhbHNlLFxuICBmaXJzdExldmVsOiAxLFxuICBtYXhMZXZlbDogNixcbiAgc3R5bGVMZXZlbDE6ICcxJyxcbiAgc3R5bGVMZXZlbE90aGVyOiAnMScsXG4gIGF1dG86IGZhbHNlLFxuICBzZXBhcmF0b3I6ICcnLFxuICBjb250ZW50czogJydcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGlzVmFsaWRMZXZlbFN0eWxlIChzOiBzdHJpbmcpOiBib29sZWFuIHtcbiAgaWYgKHMgPT09ICdBJyB8fCBzID09PSAnMScpIHJldHVybiB0cnVlXG4gIHJldHVybiBmYWxzZVxufVxuXG5leHBvcnQgZnVuY3Rpb24gaXNWYWxpZEZsYWcgKGY6IHVua25vd24pOiBib29sZWFuIHtcbiAgaWYgKGYgPT09IHRydWUgfHwgZiA9PT0gZmFsc2UpIHJldHVybiB0cnVlXG4gIHJldHVybiBmYWxzZVxufVxuXG5leHBvcnQgZnVuY3Rpb24gaXNWYWxpZEZpcnN0T3JNYXhMZXZlbCAoeDogdW5rbm93bik6IGJvb2xlYW4ge1xuICBpZiAodHlwZW9mIHggPT09ICdudW1iZXInICYmIHggPj0gMSAmJiB4IDw9IDYpIHJldHVybiB0cnVlXG4gIHJldHVybiBmYWxzZVxufVxuXG5leHBvcnQgZnVuY3Rpb24gaXNWYWxpZFNlcGFyYXRvciAoeDogdW5rbm93bik6IGJvb2xlYW4ge1xuICBpZiAodHlwZW9mIHggPT09ICdzdHJpbmcnICYmICh4ID09PSAnJyB8fCB4ID09PSAnOicgfHwgeCA9PT0gJy4nIHx8IHggPT09ICctJykpIHJldHVybiB0cnVlXG4gIHJldHVybiBmYWxzZVxufVxuXG5leHBvcnQgZnVuY3Rpb24gaXNWYWxpZENvbnRlbnRzICh4OiB1bmtub3duKTogYm9vbGVhbiB7XG4gIGlmICh0eXBlb2YgeCA9PT0gJ3N0cmluZycgJiYgKHggPT09ICcnIHx8IHguc3RhcnRzV2l0aCgnXicpKSkgcmV0dXJuIHRydWVcbiAgcmV0dXJuIGZhbHNlXG59XG5cbmV4cG9ydCBmdW5jdGlvbiBkb2VzQ29udGVudHNIYXZlVmFsdWUgKHg6IHN0cmluZyk6IGJvb2xlYW4ge1xuICBpZiAoeC5sZW5ndGggPiAyICYmIHguc3RhcnRzV2l0aCgnXicpKSByZXR1cm4gdHJ1ZVxuICByZXR1cm4gZmFsc2Vcbn1cbiIsImltcG9ydCB7IENhY2hlZE1ldGFkYXRhLCBFZGl0b3IsIEVkaXRvclBvc2l0aW9uLCBGcm9udE1hdHRlckNhY2hlLCBwYXJzZUZyb250TWF0dGVyRW50cnkgfSBmcm9tICdvYnNpZGlhbidcbmltcG9ydCB7IERFRkFVTFRfU0VUVElOR1MsIGlzVmFsaWRDb250ZW50cywgaXNWYWxpZEZpcnN0T3JNYXhMZXZlbCwgaXNWYWxpZEZsYWcsIGlzVmFsaWRMZXZlbFN0eWxlLCBpc1ZhbGlkU2VwYXJhdG9yLCBOdW1iZXJIZWFkaW5nc1BsdWdpblNldHRpbmdzIH0gZnJvbSAnLi9zZXR0aW5nc1R5cGVzJ1xuXG5jb25zdCBBVVRPX1BBUlRfS0VZID0gJ2F1dG8nXG5jb25zdCBGSVJTVF9MRVZFTF9QQVJUX0tFWSA9ICdmaXJzdC1sZXZlbCdcbmNvbnN0IE1BWF9MRVZFTF9QQVJUX0tFWSA9ICdtYXgnXG5jb25zdCBDT05URU5UU19QQVJUX0tFWSA9ICdjb250ZW50cydcblxuZnVuY3Rpb24gcGFyc2VDb21wYWN0RnJvbnRNYXR0ZXJTZXR0aW5ncyAoZm06IEZyb250TWF0dGVyQ2FjaGUpOiBOdW1iZXJIZWFkaW5nc1BsdWdpblNldHRpbmdzIHwgdW5kZWZpbmVkIHtcbiAgY29uc3QgZW50cnkgPSBwYXJzZUZyb250TWF0dGVyRW50cnkoZm0sICdudW1iZXIgaGVhZGluZ3MnKVxuICBpZiAoZW50cnkpIHtcbiAgICBjb25zdCBlbnRyeVN0cmluZyA9IFN0cmluZyhlbnRyeSlcbiAgICBjb25zdCBwYXJ0cyA9IGVudHJ5U3RyaW5nLnNwbGl0KCcsJylcbiAgICBjb25zdCBzZXR0aW5nczogTnVtYmVySGVhZGluZ3NQbHVnaW5TZXR0aW5ncyA9IHsgLi4uREVGQVVMVF9TRVRUSU5HUyB9XG5cbiAgICBmb3IgKGNvbnN0IHBhcnQgb2YgcGFydHMpIHtcbiAgICAgIGNvbnN0IGNsZWFuUGFydCA9IHBhcnQudHJpbSgpXG4gICAgICBpZiAoY2xlYW5QYXJ0Lmxlbmd0aCA9PT0gMCkgY29udGludWVcblxuICAgICAgaWYgKGNsZWFuUGFydCA9PT0gQVVUT19QQVJUX0tFWSkge1xuICAgICAgICAvLyBQYXJzZSBhdXRvIG51bWJlcmluZyBwYXJ0XG4gICAgICAgIHNldHRpbmdzLmF1dG8gPSB0cnVlXG4gICAgICB9IGVsc2UgaWYgKGNsZWFuUGFydC5zdGFydHNXaXRoKEZJUlNUX0xFVkVMX1BBUlRfS0VZKSkge1xuICAgICAgICAvLyBQYXJzZSBmaXJzdCBsZXZlbCBwYXJ0XG4gICAgICAgIGNvbnN0IG5zdHJpbmcgPSBjbGVhblBhcnQuc3Vic3RyaW5nKEZJUlNUX0xFVkVMX1BBUlRfS0VZLmxlbmd0aCArIDEpXG4gICAgICAgIGNvbnN0IG4gPSBwYXJzZUludChuc3RyaW5nKVxuICAgICAgICBpZiAoaXNWYWxpZEZpcnN0T3JNYXhMZXZlbChuKSkge1xuICAgICAgICAgIHNldHRpbmdzLmZpcnN0TGV2ZWwgPSBuXG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSBpZiAoY2xlYW5QYXJ0LnN0YXJ0c1dpdGgoTUFYX0xFVkVMX1BBUlRfS0VZKSkge1xuICAgICAgICAvLyBQYXJzZSBtYXggbGV2ZWwgcGFydFxuICAgICAgICBjb25zdCBuc3RyaW5nID0gY2xlYW5QYXJ0LnN1YnN0cmluZyhNQVhfTEVWRUxfUEFSVF9LRVkubGVuZ3RoICsgMSlcbiAgICAgICAgY29uc3QgbiA9IHBhcnNlSW50KG5zdHJpbmcpXG4gICAgICAgIGlmIChpc1ZhbGlkRmlyc3RPck1heExldmVsKG4pKSB7XG4gICAgICAgICAgc2V0dGluZ3MubWF4TGV2ZWwgPSBuXG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSBpZiAoY2xlYW5QYXJ0LnN0YXJ0c1dpdGgoQ09OVEVOVFNfUEFSVF9LRVkpKSB7XG4gICAgICAgIGlmIChjbGVhblBhcnQubGVuZ3RoIDw9IENPTlRFTlRTX1BBUlRfS0VZLmxlbmd0aCArIDEpIGNvbnRpbnVlXG4gICAgICAgIC8vIFBhcnNlIGNvbnRlbnRzIGhlYWRpbmcgcGFydFxuICAgICAgICBjb25zdCB0b2NIZWFkaW5nID0gY2xlYW5QYXJ0LnN1YnN0cmluZyhDT05URU5UU19QQVJUX0tFWS5sZW5ndGggKyAxKVxuICAgICAgICBpZiAoaXNWYWxpZENvbnRlbnRzKHRvY0hlYWRpbmcpKSB7XG4gICAgICAgICAgc2V0dGluZ3MuY29udGVudHMgPSB0b2NIZWFkaW5nXG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIC8vIFBhcnNlIGZvcm1hdHRpbmcgcGFydFxuICAgICAgICBjb25zdCBsYXN0Q2hhciA9IGNsZWFuUGFydFtjbGVhblBhcnQubGVuZ3RoIC0gMV1cbiAgICAgICAgbGV0IHJlbWFpbmluZ1BhcnQgPSBjbGVhblBhcnRcbiAgICAgICAgaWYgKGlzVmFsaWRTZXBhcmF0b3IobGFzdENoYXIpKSB7XG4gICAgICAgICAgc2V0dGluZ3Muc2VwYXJhdG9yID0gbGFzdENoYXJcbiAgICAgICAgICByZW1haW5pbmdQYXJ0ID0gY2xlYW5QYXJ0LnN1YnN0cmluZygwLCBjbGVhblBhcnQubGVuZ3RoIC0gMSlcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBkZXNjcmlwdG9ycyA9IHJlbWFpbmluZ1BhcnQuc3BsaXQoJy4nKVxuICAgICAgICBsZXQgZmlyc3ROdW1iZXJlZERlc2NyaXB0b3IgPSAwXG4gICAgICAgIGlmIChkZXNjcmlwdG9ycy5sZW5ndGggPiAxICYmIGRlc2NyaXB0b3JzWzBdID09PSAnXycpIHtcbiAgICAgICAgICBzZXR0aW5ncy5za2lwVG9wTGV2ZWwgPSB0cnVlXG4gICAgICAgICAgZmlyc3ROdW1iZXJlZERlc2NyaXB0b3IgPSAxXG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgc2V0dGluZ3Muc2tpcFRvcExldmVsID0gZmFsc2VcbiAgICAgICAgfVxuICAgICAgICBpZiAoZGVzY3JpcHRvcnMubGVuZ3RoIC0gZmlyc3ROdW1iZXJlZERlc2NyaXB0b3IgPj0gMikge1xuICAgICAgICAgIGNvbnN0IHN0eWxlTGV2ZWwxID0gZGVzY3JpcHRvcnNbZmlyc3ROdW1iZXJlZERlc2NyaXB0b3JdXG4gICAgICAgICAgaWYgKGlzVmFsaWRMZXZlbFN0eWxlKHN0eWxlTGV2ZWwxKSkge1xuICAgICAgICAgICAgc2V0dGluZ3Muc3R5bGVMZXZlbDEgPSBzdHlsZUxldmVsMVxuICAgICAgICAgIH1cbiAgICAgICAgICBjb25zdCBzdHlsZUxldmVsT3RoZXIgPSBkZXNjcmlwdG9yc1tmaXJzdE51bWJlcmVkRGVzY3JpcHRvciArIDFdXG4gICAgICAgICAgaWYgKGlzVmFsaWRMZXZlbFN0eWxlKHN0eWxlTGV2ZWxPdGhlcikpIHtcbiAgICAgICAgICAgIHNldHRpbmdzLnN0eWxlTGV2ZWxPdGhlciA9IHN0eWxlTGV2ZWxPdGhlclxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiBzZXR0aW5nc1xuICB9XG5cbiAgcmV0dXJuIHVuZGVmaW5lZFxufVxuXG5leHBvcnQgY29uc3QgZ2V0RnJvbnRNYXR0ZXJTZXR0aW5nc09yQWx0ZXJuYXRpdmUgPSAoXG4gIHsgZnJvbnRtYXR0ZXIgfTogQ2FjaGVkTWV0YWRhdGEsXG4gIGFsdGVybmF0aXZlU2V0dGluZ3M6IE51bWJlckhlYWRpbmdzUGx1Z2luU2V0dGluZ3Ncbik6IE51bWJlckhlYWRpbmdzUGx1Z2luU2V0dGluZ3MgPT4ge1xuICBpZiAoZnJvbnRtYXR0ZXIgIT09IHVuZGVmaW5lZCkge1xuICAgIGNvbnN0IGRlY29tcGFjdGVkU2V0dGluZ3MgPSBwYXJzZUNvbXBhY3RGcm9udE1hdHRlclNldHRpbmdzKGZyb250bWF0dGVyKVxuICAgIGlmIChkZWNvbXBhY3RlZFNldHRpbmdzICE9PSB1bmRlZmluZWQpIHJldHVybiBkZWNvbXBhY3RlZFNldHRpbmdzXG5cbiAgICAvLyBOT1RFOiBFdmVyeXRoaW5nIGJlbG93IGlzIGZvciBiYWNrd2FyZHMgY29tcGF0aWJpbGl0eSBvbmx5XG5cbiAgICBjb25zdCBza2lwVG9wTGV2ZWxFbnRyeSA9IHBhcnNlRnJvbnRNYXR0ZXJFbnRyeShmcm9udG1hdHRlciwgJ251bWJlci1oZWFkaW5ncy1za2lwLXRvcC1sZXZlbCcpID8/IHBhcnNlRnJvbnRNYXR0ZXJFbnRyeShmcm9udG1hdHRlciwgJ2hlYWRlci1udW1iZXJpbmctc2tpcC10b3AtbGV2ZWwnKVxuICAgIGNvbnN0IHNraXBUb3BMZXZlbCA9IGlzVmFsaWRGbGFnKHNraXBUb3BMZXZlbEVudHJ5KSA/IHNraXBUb3BMZXZlbEVudHJ5IDogYWx0ZXJuYXRpdmVTZXR0aW5ncy5za2lwVG9wTGV2ZWxcblxuICAgIGNvbnN0IG1heExldmVsRW50cnkgPSBwYXJzZUZyb250TWF0dGVyRW50cnkoZnJvbnRtYXR0ZXIsICdudW1iZXItaGVhZGluZ3MtbWF4LWxldmVsJykgPz8gcGFyc2VGcm9udE1hdHRlckVudHJ5KGZyb250bWF0dGVyLCAnaGVhZGVyLW51bWJlcmluZy1tYXgtbGV2ZWwnKVxuICAgIGNvbnN0IG1heExldmVsID0gaXNWYWxpZEZpcnN0T3JNYXhMZXZlbChtYXhMZXZlbEVudHJ5KSA/IG1heExldmVsRW50cnkgOiBhbHRlcm5hdGl2ZVNldHRpbmdzLm1heExldmVsXG5cbiAgICBjb25zdCBzdHlsZUxldmVsMUVudHJ5ID0gU3RyaW5nKFxuICAgICAgcGFyc2VGcm9udE1hdHRlckVudHJ5KGZyb250bWF0dGVyLCAnbnVtYmVyLWhlYWRpbmdzLXN0eWxlLWxldmVsLTEnKSA/P1xuICAgICAgcGFyc2VGcm9udE1hdHRlckVudHJ5KGZyb250bWF0dGVyLCAnaGVhZGVyLW51bWJlcmluZy1zdHlsZS1sZXZlbC0xJylcbiAgICApXG4gICAgY29uc3Qgc3R5bGVMZXZlbDEgPSBpc1ZhbGlkTGV2ZWxTdHlsZShzdHlsZUxldmVsMUVudHJ5KSA/IHN0eWxlTGV2ZWwxRW50cnkgOiBhbHRlcm5hdGl2ZVNldHRpbmdzLnN0eWxlTGV2ZWwxXG5cbiAgICBjb25zdCBzdHlsZUxldmVsT3RoZXJFbnRyeSA9IFN0cmluZyhcbiAgICAgIHBhcnNlRnJvbnRNYXR0ZXJFbnRyeShmcm9udG1hdHRlciwgJ251bWJlci1oZWFkaW5ncy1zdHlsZS1sZXZlbC1vdGhlcicpID8/XG4gICAgICBwYXJzZUZyb250TWF0dGVyRW50cnkoZnJvbnRtYXR0ZXIsICdoZWFkZXItbnVtYmVyaW5nLXN0eWxlLWxldmVsLW90aGVyJylcbiAgICApXG4gICAgY29uc3Qgc3R5bGVMZXZlbE90aGVyID0gaXNWYWxpZExldmVsU3R5bGUoc3R5bGVMZXZlbE90aGVyRW50cnkpID8gc3R5bGVMZXZlbE90aGVyRW50cnkgOiBhbHRlcm5hdGl2ZVNldHRpbmdzLnN0eWxlTGV2ZWxPdGhlclxuXG4gICAgY29uc3QgYXV0b0VudHJ5ID0gcGFyc2VGcm9udE1hdHRlckVudHJ5KGZyb250bWF0dGVyLCAnbnVtYmVyLWhlYWRpbmdzLWF1dG8nKSA/PyBwYXJzZUZyb250TWF0dGVyRW50cnkoZnJvbnRtYXR0ZXIsICdoZWFkZXItbnVtYmVyaW5nLWF1dG8nKVxuICAgIGNvbnN0IGF1dG8gPSBpc1ZhbGlkRmxhZyhhdXRvRW50cnkpID8gYXV0b0VudHJ5IDogYWx0ZXJuYXRpdmVTZXR0aW5ncy5hdXRvXG5cbiAgICByZXR1cm4geyAuLi5hbHRlcm5hdGl2ZVNldHRpbmdzLCBza2lwVG9wTGV2ZWwsIG1heExldmVsLCBzdHlsZUxldmVsMSwgc3R5bGVMZXZlbE90aGVyLCBhdXRvIH1cbiAgfSBlbHNlIHtcbiAgICByZXR1cm4gYWx0ZXJuYXRpdmVTZXR0aW5nc1xuICB9XG59XG5cbmZ1bmN0aW9uIHNldHRpbmdzVG9Db21wYWN0RnJvbnRNYXR0ZXJWYWx1ZSAoc2V0dGluZ3M6IE51bWJlckhlYWRpbmdzUGx1Z2luU2V0dGluZ3MpOiBzdHJpbmcge1xuICBjb25zdCBhdXRvUGFydCA9IHNldHRpbmdzLmF1dG8gPyAnYXV0bywgJyA6ICcnXG4gIGNvbnN0IGZpcnN0TGV2ZWxQYXJ0ID0gYGZpcnN0LWxldmVsICR7c2V0dGluZ3MuZmlyc3RMZXZlbH0sIGBcbiAgY29uc3QgbWF4UGFydCA9IGBtYXggJHtzZXR0aW5ncy5tYXhMZXZlbH0sIGBcbiAgY29uc3QgY29udGVudHNQYXJ0ID0gc2V0dGluZ3MuY29udGVudHMgJiYgc2V0dGluZ3MuY29udGVudHMubGVuZ3RoID4gMCA/IGBjb250ZW50cyAke3NldHRpbmdzLmNvbnRlbnRzfSwgYCA6ICcnXG4gIGNvbnN0IHNraXBUb3BMZXZlbFN0cmluZyA9IHNldHRpbmdzLnNraXBUb3BMZXZlbCA/ICdfLicgOiAnJ1xuICBjb25zdCBzdHlsZVBhcnQgPSBgJHtza2lwVG9wTGV2ZWxTdHJpbmd9JHtzZXR0aW5ncy5zdHlsZUxldmVsMX0uJHtzZXR0aW5ncy5zdHlsZUxldmVsT3RoZXJ9JHtzZXR0aW5ncy5zZXBhcmF0b3J9YFxuICByZXR1cm4gYXV0b1BhcnQgKyBmaXJzdExldmVsUGFydCArIG1heFBhcnQgKyBjb250ZW50c1BhcnQgKyBzdHlsZVBhcnRcbn1cblxuZnVuY3Rpb24gZmluZExpbmVXaGljaFN0YXJ0c1dpdGggKGVkaXRvcjogRWRpdG9yLCBzZWFyY2g6IHN0cmluZywgYWZ0ZXJMaW5lOiBudW1iZXIpOiBudW1iZXIgfCB1bmRlZmluZWQge1xuICAvLyBGaW5kIHRoZSBsb2NhdGlvbiBvZiB0aGUgZnJvbnRtYXR0ZXJcbiAgZm9yIChsZXQgaSA9IGFmdGVyTGluZTsgaSA8IGVkaXRvci5sYXN0TGluZSgpOyBpKyspIHtcbiAgICBjb25zdCBsaW5lU3RyaW5nID0gZWRpdG9yLmdldExpbmUoaSlcbiAgICBpZiAobGluZVN0cmluZy5zdGFydHNXaXRoKHNlYXJjaCkpIHtcbiAgICAgIHJldHVybiBpXG4gICAgfVxuICB9XG4gIHJldHVybiB1bmRlZmluZWRcbn1cblxuZXhwb3J0IGNvbnN0IHNhdmVTZXR0aW5nc1RvRnJvbnRNYXR0ZXIgPSAoXG4gIHsgZnJvbnRtYXR0ZXIgfTogQ2FjaGVkTWV0YWRhdGEsXG4gIGVkaXRvcjogRWRpdG9yLFxuICBzZXR0aW5nczogTnVtYmVySGVhZGluZ3NQbHVnaW5TZXR0aW5nc1xuKTogdm9pZCA9PiB7XG4gIGlmIChmcm9udG1hdHRlciAhPT0gdW5kZWZpbmVkKSB7XG4gICAgLy8gRnJvbnQgbWF0dGVyIGFscmVhZHkgZXhpc3RzLCBzbyB3ZSdsbCBuZWVkIHRvIGluc2VydCB0aGUgc2V0dGluZ3MgaW50byB0aGUgZnJvbnQgbWF0dGVyXG5cbiAgICBjb25zdCBmcm9udE1hdHRlckxpbmUgPSBmcm9udG1hdHRlci5wb3NpdGlvbi5zdGFydC5saW5lXG4gICAgY29uc3QgdiA9IHNldHRpbmdzVG9Db21wYWN0RnJvbnRNYXR0ZXJWYWx1ZShzZXR0aW5ncylcbiAgICBjb25zdCBmcm9udE1hdHRlckFkZGl0aW9ucyA9IGBudW1iZXIgaGVhZGluZ3M6ICR7dn1cXG5gXG5cbiAgICBpZiAoZnJvbnRtYXR0ZXJbJ251bWJlciBoZWFkaW5ncyddICE9PSB1bmRlZmluZWQpIHtcbiAgICAgIC8vIEtleSBhbHJlYWR5IHByZXNlbnQsIHJlcGxhY2UgaXRcbiAgICAgIGNvbnN0IGtleUxpbmUgPSBmaW5kTGluZVdoaWNoU3RhcnRzV2l0aChlZGl0b3IsICdudW1iZXIgaGVhZGluZ3MnLCBmcm9udE1hdHRlckxpbmUpXG4gICAgICBpZiAoa2V5TGluZSA9PT0gdW5kZWZpbmVkKSB0aHJvdyBuZXcgRXJyb3IoJ051bWJlciBIZWFkaW5ncyBQbHVnaW46IFwibnVtYmVyIGhlYWRpbmdzXCIga2V5IGV4aXN0cyBidXQgbm90IGZvdW5kLicpXG4gICAgICBjb25zdCBmcm9tOiBFZGl0b3JQb3NpdGlvbiA9IHsgbGluZToga2V5TGluZSwgY2g6IDAgfVxuICAgICAgY29uc3QgdG86IEVkaXRvclBvc2l0aW9uID0geyBsaW5lOiBrZXlMaW5lICsgMSwgY2g6IDAgfVxuICAgICAgZWRpdG9yLnJlcGxhY2VSYW5nZShmcm9udE1hdHRlckFkZGl0aW9ucywgZnJvbSwgdG8pXG4gICAgfSBlbHNlIHtcbiAgICAgIC8vIEtleSBub3QgcHJlc2VudCwgaW5zZXJ0IG5ldyBrZXlcbiAgICAgIGNvbnN0IGZyb206IEVkaXRvclBvc2l0aW9uID0geyBsaW5lOiBmcm9udE1hdHRlckxpbmUgKyAxLCBjaDogMCB9XG4gICAgICBjb25zdCB0bzogRWRpdG9yUG9zaXRpb24gPSB7IGxpbmU6IGZyb250TWF0dGVyTGluZSArIDEsIGNoOiAwIH1cbiAgICAgIGVkaXRvci5yZXBsYWNlUmFuZ2UoZnJvbnRNYXR0ZXJBZGRpdGlvbnMsIGZyb20sIHRvKVxuICAgIH1cbiAgfSBlbHNlIHtcbiAgICAvLyBObyBmcm9udG1hdHRlciBmb3VuZCwgY3JlYXRlIGZyb250bWF0dGVyIGZyb20gc2NyYXRjaFxuICAgIGNvbnN0IHYgPSBzZXR0aW5nc1RvQ29tcGFjdEZyb250TWF0dGVyVmFsdWUoc2V0dGluZ3MpXG4gICAgY29uc3QgbmV3RnJvbnRNYXR0ZXIgPSBgLS0tXFxubnVtYmVyIGhlYWRpbmdzOiAke3Z9XFxuLS0tXFxuXFxuYFxuICAgIGNvbnN0IGZyb206IEVkaXRvclBvc2l0aW9uID0geyBsaW5lOiAwLCBjaDogMCB9XG4gICAgY29uc3QgdG86IEVkaXRvclBvc2l0aW9uID0geyBsaW5lOiAwLCBjaDogMCB9XG4gICAgZWRpdG9yLnJlcGxhY2VSYW5nZShuZXdGcm9udE1hdHRlciwgZnJvbSwgdG8pXG4gICAgLy8gRnJvbnQgbWF0dGVyIGRvZXMgbm90IGV4aXN0LCBzbyB3ZSB3aWxsIGNyZWF0ZSBpdCBmcm9tIHNjcmF0Y2hcbiAgfVxufVxuIiwiaW1wb3J0IHsgQXBwLCBNb2RhbCB9IGZyb20gJ29ic2lkaWFuJ1xuXG5leHBvcnQgaW50ZXJmYWNlIE51bWJlcmluZ0RvbmVDb25maWcge1xuICBtZXNzYWdlOiBzdHJpbmdcbiAgcHJlZm9ybWF0dGVkTWVzc2FnZTogc3RyaW5nXG4gIHNhdmVTZXR0aW5nc0NhbGxiYWNrOiAoc2hvdWxkQWRkQXV0b0ZsYWc6IGJvb2xlYW4pID0+IHZvaWRcbn1cblxuY2xhc3MgTnVtYmVyaW5nRG9uZU1vZGFsIGV4dGVuZHMgTW9kYWwge1xuICBjb25maWc6IE51bWJlcmluZ0RvbmVDb25maWdcblxuICBjb25zdHJ1Y3RvciAoYXBwOiBBcHAsIGNvbmZpZzogTnVtYmVyaW5nRG9uZUNvbmZpZykge1xuICAgIHN1cGVyKGFwcClcbiAgICB0aGlzLmNvbmZpZyA9IGNvbmZpZ1xuICB9XG5cbiAgb25PcGVuICgpOiB2b2lkIHtcbiAgICBjb25zdCB7IGNvbnRlbnRFbCwgdGl0bGVFbCB9ID0gdGhpc1xuICAgIHRpdGxlRWwuc2V0VGV4dCgnTnVtYmVyIEhlYWRpbmdzIC0gU3VjY2Vzc2Z1bGx5IENvbXBsZXRlZCcpXG5cbiAgICBjb250ZW50RWwuY3JlYXRlRWwoJ2RpdicsIHsgdGV4dDogdGhpcy5jb25maWcubWVzc2FnZSB9KVxuICAgIGNvbnRlbnRFbC5jcmVhdGVFbCgncHJlJywgeyB0ZXh0OiB0aGlzLmNvbmZpZy5wcmVmb3JtYXR0ZWRNZXNzYWdlIH0pXG5cbiAgICBjb250ZW50RWwuY3JlYXRlRWwoJ2RpdicsIHsgdGV4dDogXCJEbyB5b3Ugd2FudCB0byBzYXZlIHRoZXNlIHNldHRpbmdzIGluIHRoZSBkb2N1bWVudCdzIGZyb250IG1hdHRlcj9cIiwgY2xzOiAnbnVtYmVyLWhlYWRpbmdzLXF1ZXN0aW9uJyB9KVxuXG4gICAgY29uc3QgY29udGFpbmVyRm9yQnV0dG9ucyA9IGNvbnRlbnRFbC5jcmVhdGVFbCgnZGl2JywgeyBjbHM6ICdudW1iZXItaGVhZGluZ3MtYnV0dG9uLWNvbnRhaW5lcicgfSlcblxuICAgIGNvbnN0IG5vQnV0dG9uID0gY29udGFpbmVyRm9yQnV0dG9ucy5jcmVhdGVFbCgnYnV0dG9uJywgeyB9KVxuICAgIG5vQnV0dG9uLnNldFRleHQoJ05vJylcbiAgICBub0J1dHRvbi5vbkNsaWNrRXZlbnQoKGV2OiBNb3VzZUV2ZW50KSA9PiB7XG4gICAgICB0aGlzLmNsb3NlKClcbiAgICAgIHJldHVybiBldlxuICAgIH0pXG5cbiAgICBjb25zdCB5ZXNCdXR0b24gPSBjb250YWluZXJGb3JCdXR0b25zLmNyZWF0ZUVsKCdidXR0b24nLCB7IH0pXG4gICAgeWVzQnV0dG9uLnNldFRleHQoJ1llcywgc2F2ZSBzZXR0aW5ncyBpbiBkb2N1bWVudCcpXG4gICAgeWVzQnV0dG9uLm9uQ2xpY2tFdmVudCgoZXY6IE1vdXNlRXZlbnQpID0+IHtcbiAgICAgIHRoaXMuY29uZmlnLnNhdmVTZXR0aW5nc0NhbGxiYWNrKGZhbHNlKVxuICAgICAgdGhpcy5jbG9zZSgpXG4gICAgICByZXR1cm4gZXZcbiAgICB9KVxuXG4gICAgY29uc3QgeWVzQW5kQXV0b0J1dHRvbiA9IGNvbnRhaW5lckZvckJ1dHRvbnMuY3JlYXRlRWwoJ2J1dHRvbicsIHsgfSlcbiAgICB5ZXNBbmRBdXRvQnV0dG9uLnNldFRleHQoJ1llcywgc2F2ZSBzZXR0aW5ncyBpbiBkb2N1bWVudCwgYW5kIGF1dG9tYXRpY2FsbHkgbnVtYmVyJylcbiAgICB5ZXNBbmRBdXRvQnV0dG9uLm9uQ2xpY2tFdmVudCgoZXY6IE1vdXNlRXZlbnQpID0+IHtcbiAgICAgIHRoaXMuY29uZmlnLnNhdmVTZXR0aW5nc0NhbGxiYWNrKHRydWUpXG4gICAgICB0aGlzLmNsb3NlKClcbiAgICAgIHJldHVybiBldlxuICAgIH0pXG4gIH1cblxuICBvbkNsb3NlICgpOiB2b2lkIHtcbiAgICBjb25zdCB7IGNvbnRlbnRFbCwgdGl0bGVFbCB9ID0gdGhpc1xuICAgIGNvbnRlbnRFbC5lbXB0eSgpXG4gICAgdGl0bGVFbC5lbXB0eSgpXG4gIH1cbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHNob3dOdW1iZXJpbmdEb25lTWVzc2FnZSAoYXBwOiBBcHAsIGNvbmZpZzogTnVtYmVyaW5nRG9uZUNvbmZpZyk6IHZvaWQge1xuICBjb25zdCBsZWFmID0gYXBwLndvcmtzcGFjZS5hY3RpdmVMZWFmXG4gIGlmIChsZWFmKSB7XG4gICAgbmV3IE51bWJlcmluZ0RvbmVNb2RhbChhcHAsIGNvbmZpZykub3BlbigpXG4gIH1cbn1cbiIsImltcG9ydCB7IEVkaXRvciwgRWRpdG9yQ2hhbmdlLCBFZGl0b3JSYW5nZSwgSGVhZGluZ0NhY2hlIH0gZnJvbSAnb2JzaWRpYW4nXG5pbXBvcnQgeyBWaWV3SW5mbyB9IGZyb20gJy4vYWN0aXZlVmlld0hlbHBlcnMnXG5pbXBvcnQgeyBkb2VzQ29udGVudHNIYXZlVmFsdWUsIE51bWJlckhlYWRpbmdzUGx1Z2luU2V0dGluZ3MgfSBmcm9tICcuL3NldHRpbmdzVHlwZXMnXG5cbmNvbnN0IFRPQ19MSVNUX0lURU1fQlVMTEVUID0gJy0nXG5cbmZ1bmN0aW9uIG1ha2VIZWFkaW5nSGFzaFN0cmluZyAoZWRpdG9yOiBFZGl0b3IsIGhlYWRpbmc6IEhlYWRpbmdDYWNoZSk6IHN0cmluZyB8IHVuZGVmaW5lZCB7XG4gIGNvbnN0IHJlZ2V4ID0gL15cXHN7MCw0fSMrL2dcbiAgY29uc3QgaGVhZGluZ0xpbmVTdHJpbmcgPSBlZGl0b3IuZ2V0TGluZShoZWFkaW5nLnBvc2l0aW9uLnN0YXJ0LmxpbmUpXG4gIGlmICghaGVhZGluZ0xpbmVTdHJpbmcpIHJldHVybiB1bmRlZmluZWRcblxuICBjb25zdCBtYXRjaGVzID0gaGVhZGluZ0xpbmVTdHJpbmcubWF0Y2gocmVnZXgpXG4gIGlmICghbWF0Y2hlcykgcmV0dXJuIHVuZGVmaW5lZFxuXG4gIGlmIChtYXRjaGVzLmxlbmd0aCAhPT0gMSkge1xuICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby1jb25zb2xlXG4gICAgY29uc29sZS5sb2coXCJVbmV4cGVjdGVkIGhlYWRpbmcgZm9ybWF0OiAnXCIgKyBoZWFkaW5nTGluZVN0cmluZyArIFwiJ1wiKVxuICAgIHJldHVybiB1bmRlZmluZWRcbiAgfVxuXG4gIGNvbnN0IG1hdGNoID0gbWF0Y2hlc1swXVxuICByZXR1cm4gbWF0Y2gudHJpbUxlZnQoKVxufVxuXG5mdW5jdGlvbiBtYWtlTnVtYmVyaW5nU3RyaW5nIChudW1iZXJpbmdTdGFjazogTnVtYmVyaW5nVG9rZW5bXSk6IHN0cmluZyB7XG4gIGxldCBudW1iZXJpbmdTdHJpbmcgPSAnJ1xuXG4gIGZvciAobGV0IGkgPSAwOyBpIDwgbnVtYmVyaW5nU3RhY2subGVuZ3RoOyBpKyspIHtcbiAgICBpZiAoaSA9PT0gMCkge1xuICAgICAgbnVtYmVyaW5nU3RyaW5nICs9ICcgJ1xuICAgIH0gZWxzZSB7XG4gICAgICBudW1iZXJpbmdTdHJpbmcgKz0gJy4nXG4gICAgfVxuICAgIG51bWJlcmluZ1N0cmluZyArPSBudW1iZXJpbmdTdGFja1tpXS50b1N0cmluZygpXG4gIH1cblxuICByZXR1cm4gbnVtYmVyaW5nU3RyaW5nXG59XG5cbmZ1bmN0aW9uIGdldEhlYWRpbmdQcmVmaXhSYW5nZSAoZWRpdG9yOiBFZGl0b3IsIGhlYWRpbmc6IEhlYWRpbmdDYWNoZSk6IEVkaXRvclJhbmdlIHwgdW5kZWZpbmVkIHtcbiAgY29uc3QgcmVnZXggPSAvXlxcc3swLDR9IysoICk/KFswLTldK1xcLnxbQS1aXVxcLikqKFswLTldK3xbQS1aXSk/WzouLV0/KCApKy9nXG4gIGNvbnN0IGhlYWRpbmdMaW5lU3RyaW5nID0gZWRpdG9yLmdldExpbmUoaGVhZGluZy5wb3NpdGlvbi5zdGFydC5saW5lKVxuICBpZiAoIWhlYWRpbmdMaW5lU3RyaW5nKSByZXR1cm4gdW5kZWZpbmVkXG5cbiAgY29uc3QgbWF0Y2hlcyA9IGhlYWRpbmdMaW5lU3RyaW5nLm1hdGNoKHJlZ2V4KVxuXG4gIGlmIChtYXRjaGVzICYmIG1hdGNoZXMubGVuZ3RoICE9PSAxKSB7XG4gICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLWNvbnNvbGVcbiAgICBjb25zb2xlLmxvZyhcIlVuZXhwZWN0ZWQgaGVhZGluZyBmb3JtYXQ6ICdcIiArIGhlYWRpbmdMaW5lU3RyaW5nICsgXCInXCIpXG4gICAgcmV0dXJuIHVuZGVmaW5lZFxuICB9XG5cbiAgY29uc3QgbWF0Y2ggPSBtYXRjaGVzID8gbWF0Y2hlc1swXSA6ICcnXG5cbiAgY29uc3QgZnJvbSA9IHtcbiAgICBsaW5lOiBoZWFkaW5nLnBvc2l0aW9uLnN0YXJ0LmxpbmUsXG4gICAgY2g6IDBcbiAgfVxuICBjb25zdCB0byA9IHtcbiAgICBsaW5lOiBoZWFkaW5nLnBvc2l0aW9uLnN0YXJ0LmxpbmUsXG4gICAgY2g6IG1hdGNoLmxlbmd0aFxuICB9XG5cbiAgcmV0dXJuIHsgZnJvbSwgdG8gfVxufVxuXG50eXBlIE51bWJlcmluZ1Rva2VuID0gc3RyaW5nIHwgbnVtYmVyXG5cbmZ1bmN0aW9uIHplcm90aE51bWJlcmluZ1Rva2VuSW5TdHlsZSAoc3R5bGU6IHN0cmluZyk6IE51bWJlcmluZ1Rva2VuIHtcbiAgaWYgKHN0eWxlID09PSAnMScpIHtcbiAgICByZXR1cm4gMFxuICB9IGVsc2UgaWYgKHN0eWxlID09PSAnQScpIHtcbiAgICByZXR1cm4gJ1onXG4gIH1cblxuICByZXR1cm4gMFxufVxuXG5mdW5jdGlvbiBmaXJzdE51bWJlcmluZ1Rva2VuSW5TdHlsZSAoc3R5bGU6IHN0cmluZyk6IE51bWJlcmluZ1Rva2VuIHtcbiAgaWYgKHN0eWxlID09PSAnMScpIHtcbiAgICByZXR1cm4gMVxuICB9IGVsc2UgaWYgKHN0eWxlID09PSAnQScpIHtcbiAgICByZXR1cm4gJ0EnXG4gIH1cblxuICByZXR1cm4gMVxufVxuXG5mdW5jdGlvbiBuZXh0TnVtYmVyaW5nVG9rZW4gKHQ6IE51bWJlcmluZ1Rva2VuKTogTnVtYmVyaW5nVG9rZW4ge1xuICBpZiAodHlwZW9mIHQgPT09ICdudW1iZXInKSB7XG4gICAgcmV0dXJuIHQgKyAxXG4gIH1cblxuICBpZiAodHlwZW9mIHQgPT09ICdzdHJpbmcnKSB7XG4gICAgaWYgKHQgPT09ICdaJykgcmV0dXJuICdBJ1xuICAgIGVsc2UgcmV0dXJuIFN0cmluZy5mcm9tQ2hhckNvZGUodC5jaGFyQ29kZUF0KDApICsgMSlcbiAgfVxuXG4gIHJldHVybiAxXG59XG5cbmZ1bmN0aW9uIGNsZWFuSGVhZGluZ1RleHRGb3JUb2MgKGh0ZXh0OiBzdHJpbmcpOiBzdHJpbmcge1xuICBpZiAoaHRleHQuY29udGFpbnMoJ14nKSkge1xuICAgIGNvbnN0IHggPSBodGV4dC5zcGxpdCgnXicpXG4gICAgaWYgKHgubGVuZ3RoID4gMSkge1xuICAgICAgcmV0dXJuIHhbMF0udHJpbSgpXG4gICAgfVxuICB9XG4gIHJldHVybiBodGV4dC50cmltKClcbn1cblxuLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby11bnVzZWQtdmFyc1xuZnVuY3Rpb24gY3JlYXRlVG9jRW50cnkgKGg6IEhlYWRpbmdDYWNoZSwgc2V0dGluZ3M6IE51bWJlckhlYWRpbmdzUGx1Z2luU2V0dGluZ3MpOnN0cmluZyB7XG4gIGNvbnN0IHRleHQgPSBoLmhlYWRpbmdcbiAgY29uc3QgY2xlYW5UZXh0ID0gY2xlYW5IZWFkaW5nVGV4dEZvclRvYyh0ZXh0KVxuXG4gIGxldCBidWxsZXRJbmRlbnQgPSAnJ1xuICBjb25zdCBzdGFydExldmVsID0gMVxuICBmb3IgKGxldCBpID0gc3RhcnRMZXZlbDsgaSA8IGgubGV2ZWw7IGkrKykge1xuICAgIGJ1bGxldEluZGVudCArPSAnXFx0J1xuICB9XG5cbiAgY29uc3QgZW50cnlMaW5rID0gYFtbIyR7dGV4dH18JHtjbGVhblRleHR9XV1gXG5cbiAgcmV0dXJuIGJ1bGxldEluZGVudCArIFRPQ19MSVNUX0lURU1fQlVMTEVUICsgJyAnICsgZW50cnlMaW5rXG59XG5cbi8vIFJlcGxhY2UgYSByYW5nZSwgYnV0IG9ubHkgaWYgdGhlcmUgaXMgYSBjaGFuZ2UgaW4gdGV4dCwgdG8gcHJldmVudCBwb2x1dGluZyB0aGUgdW5kbyBzdGFja1xuZnVuY3Rpb24gcmVwbGFjZVJhbmdlU2FmZWx5IChlZGl0b3I6IEVkaXRvciwgY2hhbmdlczogRWRpdG9yQ2hhbmdlW10sIHJhbmdlOiBFZGl0b3JSYW5nZSwgdGV4dDogc3RyaW5nKTogdm9pZCB7XG4gIGNvbnN0IHByZXZpb3VzVGV4dCA9IGVkaXRvci5nZXRSYW5nZShyYW5nZS5mcm9tLCByYW5nZS50bylcblxuICBpZiAocHJldmlvdXNUZXh0ICE9PSB0ZXh0KSB7XG4gICAgY2hhbmdlcy5wdXNoKHtcbiAgICAgIHRleHQ6IHRleHQsXG4gICAgICBmcm9tOiByYW5nZS5mcm9tLFxuICAgICAgdG86IHJhbmdlLnRvXG4gICAgfSlcbiAgfVxufVxuXG5leHBvcnQgY29uc3QgdXBkYXRlSGVhZGluZ051bWJlcmluZyA9IChcbiAgdmlld0luZm86IFZpZXdJbmZvIHwgdW5kZWZpbmVkLFxuICBzZXR0aW5nczogTnVtYmVySGVhZGluZ3NQbHVnaW5TZXR0aW5nc1xuKTogdm9pZCA9PiB7XG4gIGlmICghdmlld0luZm8pIHJldHVyblxuICBjb25zdCBoZWFkaW5ncyA9IHZpZXdJbmZvLmRhdGEuaGVhZGluZ3MgPz8gW11cbiAgY29uc3QgZWRpdG9yID0gdmlld0luZm8uZWRpdG9yXG5cbiAgbGV0IHByZXZpb3VzTGV2ZWwgPSAxXG5cbiAgY29uc3QgbnVtYmVyaW5nU3RhY2s6IE51bWJlcmluZ1Rva2VuW10gPSBbemVyb3RoTnVtYmVyaW5nVG9rZW5JblN0eWxlKHNldHRpbmdzLnN0eWxlTGV2ZWwxKV1cblxuICBpZiAoc2V0dGluZ3MuZmlyc3RMZXZlbCA+IDEpIHtcbiAgICBwcmV2aW91c0xldmVsID0gc2V0dGluZ3MuZmlyc3RMZXZlbFxuICB9IGVsc2UgaWYgKHNldHRpbmdzLnNraXBUb3BMZXZlbCkge1xuICAgIHByZXZpb3VzTGV2ZWwgPSAyXG4gIH1cblxuICBjb25zdCBjaGFuZ2VzOiBFZGl0b3JDaGFuZ2VbXSA9IFtdXG5cbiAgZm9yIChjb25zdCBoZWFkaW5nIG9mIGhlYWRpbmdzKSB7XG4gICAgLy8gVXBkYXRlIHRoZSBudW1iZXJpbmcgc3RhY2sgYmFzZWQgb24gdGhlIGxldmVsIGFuZCBwcmV2aW91cyBsZXZlbFxuXG4gICAgY29uc3QgbGV2ZWwgPSBoZWFkaW5nLmxldmVsXG5cbiAgICAvLyBIYW5kbGUgc2tpcHBlZCAmIGlnbm9yZWQgbGV2ZWxzXG4gICAgaWYgKHNldHRpbmdzLmZpcnN0TGV2ZWwgPiBsZXZlbCkge1xuICAgICAgLy8gTGVhdmUgdGhlc2UgaGVhZGluZ3MgYXMgdGhleSBhcmUgKHRoaXMgYWxsb3dzIHBlb3BsZSB0byBoYXZlIG51bWJlcnMgYXQgdGhlIHN0YXJ0IG9mIGlnbm9yZWQgaGVhZGluZ3MpXG4gICAgICBjb250aW51ZVxuICAgIH0gZWxzZSBpZiAoKHNldHRpbmdzLnNraXBUb3BMZXZlbCAmJiBsZXZlbCA9PT0gMSkgfHwgKGxldmVsID4gc2V0dGluZ3MubWF4TGV2ZWwpKSB7XG4gICAgICAvLyBSZW1vdmUgYW55IGhlYWRpbmcgbnVtYmVycyBpbiB0aGVzZSB0d28gY2FzZXM6XG4gICAgICAvLyAxLiB0aGlzIGlzIGEgdG9wIGxldmVsIGFuZCB3ZSBhcmUgc2tpcHBpbmcgdG9wIGxldmVsIGhlYWRpbmdzXG4gICAgICAvLyAyLiB0aGlzIGxldmVsIGlzIGhpZ2hlciB0aGFuIHRoZSBtYXggbGV2ZWwgc2V0dGluZ1xuXG4gICAgICAvKiBUaGlzIHdvdWxkIGFsbG93IHNraXBwZWQgaGVhZGluZ3MgdG8gYmUgc3RyaXBwZWQgb2YgdGhlaXIgbnVtYmVyaW5nLCBidXQgdGhpcyBtYWtlcyBpdCBkaWZmaWN1bHQgdG8gdHJ1bHkgc2tpcCBhIGhlYWRpbmdcbiAgICAgIGNvbnN0IHByZWZpeFJhbmdlID0gZ2V0SGVhZGluZ1ByZWZpeFJhbmdlKGVkaXRvciwgaGVhZGluZylcblxuICAgICAgaWYgKHByZWZpeFJhbmdlKSB7XG4gICAgICAgIGNvbnN0IGhlYWRpbmdIYXNoU3RyaW5nID0gbWFrZUhlYWRpbmdIYXNoU3RyaW5nKGVkaXRvciwgaGVhZGluZylcbiAgICAgICAgaWYgKGhlYWRpbmdIYXNoU3RyaW5nID09PSB1bmRlZmluZWQpIGNvbnRpbnVlXG4gICAgICAgIHJlcGxhY2VSYW5nZVNhZmVseShlZGl0b3IsIGNoYW5nZXMsIHByZWZpeFJhbmdlLCBoZWFkaW5nSGFzaFN0cmluZyArICcgJylcbiAgICAgIH1cbiAgICAgICovXG5cbiAgICAgIGNvbnRpbnVlXG4gICAgfVxuXG4gICAgLy8gQWRqdXN0IG51bWJlcmluZyBzdGFja1xuICAgIGlmIChsZXZlbCA9PT0gcHJldmlvdXNMZXZlbCkge1xuICAgICAgY29uc3QgeCA9IG51bWJlcmluZ1N0YWNrLnBvcCgpXG4gICAgICBpZiAoeCAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIG51bWJlcmluZ1N0YWNrLnB1c2gobmV4dE51bWJlcmluZ1Rva2VuKHgpKVxuICAgICAgfVxuICAgIH0gZWxzZSBpZiAobGV2ZWwgPCBwcmV2aW91c0xldmVsKSB7XG4gICAgICBmb3IgKGxldCBpID0gcHJldmlvdXNMZXZlbDsgaSA+IGxldmVsOyBpLS0pIHtcbiAgICAgICAgbnVtYmVyaW5nU3RhY2sucG9wKClcbiAgICAgIH1cbiAgICAgIGNvbnN0IHggPSBudW1iZXJpbmdTdGFjay5wb3AoKVxuICAgICAgaWYgKHggIT09IHVuZGVmaW5lZCkge1xuICAgICAgICBudW1iZXJpbmdTdGFjay5wdXNoKG5leHROdW1iZXJpbmdUb2tlbih4KSlcbiAgICAgIH1cbiAgICB9IGVsc2UgaWYgKGxldmVsID4gcHJldmlvdXNMZXZlbCkge1xuICAgICAgZm9yIChsZXQgaSA9IHByZXZpb3VzTGV2ZWw7IGkgPCBsZXZlbDsgaSsrKSB7XG4gICAgICAgIG51bWJlcmluZ1N0YWNrLnB1c2goZmlyc3ROdW1iZXJpbmdUb2tlbkluU3R5bGUoc2V0dGluZ3Muc3R5bGVMZXZlbE90aGVyKSlcbiAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBTZXQgdGhlIHByZXZpb3VzIGxldmVsIHRvIHRoaXMgbGV2ZWwgZm9yIHRoZSBuZXh0IGl0ZXJhdGlvblxuICAgIHByZXZpb3VzTGV2ZWwgPSBsZXZlbFxuXG4gICAgaWYgKGxldmVsID4gc2V0dGluZ3MubWF4TGV2ZWwpIHtcbiAgICAgIC8vIElmIHdlIGFyZSBhYm92ZSB0aGUgbWF4IGxldmVsLCBqdXN0IGRvbid0IG51bWJlciBpdFxuICAgICAgY29udGludWVcbiAgICB9XG5cbiAgICAvLyBGaW5kIHRoZSByYW5nZSB0byByZXBsYWNlLCBhbmQgdGhlbiBkbyBpdFxuICAgIGNvbnN0IHByZWZpeFJhbmdlID0gZ2V0SGVhZGluZ1ByZWZpeFJhbmdlKGVkaXRvciwgaGVhZGluZylcbiAgICBpZiAocHJlZml4UmFuZ2UgPT09IHVuZGVmaW5lZCkgcmV0dXJuXG4gICAgY29uc3QgaGVhZGluZ0hhc2hTdHJpbmcgPSBtYWtlSGVhZGluZ0hhc2hTdHJpbmcoZWRpdG9yLCBoZWFkaW5nKVxuICAgIGlmIChoZWFkaW5nSGFzaFN0cmluZyA9PT0gdW5kZWZpbmVkKSByZXR1cm5cbiAgICBjb25zdCBwcmVmaXhTdHJpbmcgPSBtYWtlTnVtYmVyaW5nU3RyaW5nKG51bWJlcmluZ1N0YWNrKVxuICAgIHJlcGxhY2VSYW5nZVNhZmVseShlZGl0b3IsIGNoYW5nZXMsIHByZWZpeFJhbmdlLCBoZWFkaW5nSGFzaFN0cmluZyArIHByZWZpeFN0cmluZyArIHNldHRpbmdzLnNlcGFyYXRvciArICcgJylcbiAgfVxuXG4gIC8vIEV4ZWN1dGUgdGhlIHRyYW5zYWN0aW9uIHRvIG1ha2UgYWxsIHRoZSBjaGFuZ2VzIGF0IG9uY2VcbiAgaWYgKGNoYW5nZXMubGVuZ3RoID4gMCkge1xuICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby1jb25zb2xlXG4gICAgY29uc29sZS5sb2coJ051bWJlciBIZWFkaW5ncyBQbHVnaW46IEFwcGx5aW5nIGhlYWRpbmdzIG51bWJlcmluZyBjaGFuZ2VzOicsIGNoYW5nZXMubGVuZ3RoKVxuICAgIGVkaXRvci50cmFuc2FjdGlvbih7XG4gICAgICBjaGFuZ2VzOiBjaGFuZ2VzXG4gICAgfSlcbiAgfVxufVxuXG5leHBvcnQgY29uc3QgdXBkYXRlVGFibGVPZkNvbnRlbnRzID0gKFxuICB2aWV3SW5mbzogVmlld0luZm8gfCB1bmRlZmluZWQsXG4gIHNldHRpbmdzOiBOdW1iZXJIZWFkaW5nc1BsdWdpblNldHRpbmdzXG4pOiB2b2lkID0+IHtcbiAgaWYgKCF2aWV3SW5mbykgcmV0dXJuXG4gIGNvbnN0IGhlYWRpbmdzID0gdmlld0luZm8uZGF0YS5oZWFkaW5ncyA/PyBbXVxuICBjb25zdCBlZGl0b3IgPSB2aWV3SW5mby5lZGl0b3JcblxuICBpZiAoIWRvZXNDb250ZW50c0hhdmVWYWx1ZShzZXR0aW5ncy5jb250ZW50cykpIHJldHVyblxuXG4gIGxldCB0b2NIZWFkaW5nOiBIZWFkaW5nQ2FjaGUgfCB1bmRlZmluZWRcbiAgbGV0IHRvY0J1aWxkZXIgPSAnXFxuJ1xuICBjb25zdCBjaGFuZ2VzOiBFZGl0b3JDaGFuZ2VbXSA9IFtdXG5cbiAgZm9yIChjb25zdCBoZWFkaW5nIG9mIGhlYWRpbmdzKSB7XG4gICAgLy8gT1JERVJJTkc6IEltcG9ydGFudCB0byBmaW5kIHRoZSBUT0MgaGVhZGluZyBiZWZvcmUgc2tpcHBpbmcgc2tpcHBlZCBoZWFkaW5ncywgc2luY2UgdGhhdCBpcyBmb3IgbnVtYmVyaW5nXG5cbiAgICAvLyBGaW5kIHRoZSBUT0MgaGVhZGluZ1xuICAgIGlmIChoZWFkaW5nLmhlYWRpbmcuZW5kc1dpdGgoc2V0dGluZ3MuY29udGVudHMpKSB7XG4gICAgICB0b2NIZWFkaW5nID0gaGVhZGluZ1xuICAgIH1cblxuICAgIC8qIFRoaXMgY29kZSBsZXRzIHVzIHNraXAgVE9DIGxpbmVzIGZvciBza2lwcGVkIGhlYWRpbmdzLCBidXQgZG9lc24ndCB3b3JrIHdlbGwgd2l0aCBmaXJzdC1sZXZlbCBzZXR0aW5nXG4gICAgaWYgKChzZXR0aW5ncy5za2lwVG9wTGV2ZWwgJiYgaGVhZGluZy5sZXZlbCA9PT0gMSkgfHwgKGhlYWRpbmcubGV2ZWwgPiBzZXR0aW5ncy5tYXhMZXZlbCkpIHtcbiAgICAgIGNvbnRpbnVlXG4gICAgfVxuICAgICovXG5cbiAgICBjb25zdCB0b2NFbnRyeSA9IGNyZWF0ZVRvY0VudHJ5KGhlYWRpbmcsIHNldHRpbmdzKVxuICAgIHRvY0J1aWxkZXIgKz0gdG9jRW50cnkgKyAnXFxuJ1xuICB9XG5cbiAgLy8gSW5zZXJ0IHRoZSBnZW5lcmF0ZWQgdGFibGUgb2YgY29udGVudHNcbiAgaWYgKHRvY0hlYWRpbmcpIHtcbiAgICBjb25zdCBmcm9tID0ge1xuICAgICAgbGluZTogdG9jSGVhZGluZy5wb3NpdGlvbi5zdGFydC5saW5lICsgMSxcbiAgICAgIGNoOiAwXG4gICAgfVxuXG4gICAgY29uc3Qgc3RhcnRpbmdMaW5lID0gdG9jSGVhZGluZy5wb3NpdGlvbi5zdGFydC5saW5lICsgMVxuICAgIGxldCBlbmRpbmdMaW5lID0gMFxuICAgIGxldCBmb3VuZExpc3QgPSBmYWxzZVxuICAgIGZvciAoZW5kaW5nTGluZSA9IHN0YXJ0aW5nTGluZTsgOyBlbmRpbmdMaW5lKyspIHtcbiAgICAgIGNvbnN0IGxpbmUgPSBlZGl0b3IuZ2V0TGluZShlbmRpbmdMaW5lKVxuICAgICAgaWYgKGxpbmUgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAvLyBSZWFjaGVkIGVuZCBvZiBmaWxlLCBpbnNlcnQgYXQgdGhlIHN0YXJ0IG9mIHRoZSBUT0Mgc2VjdGlvblxuICAgICAgICBlbmRpbmdMaW5lID0gc3RhcnRpbmdMaW5lXG4gICAgICAgIGJyZWFrXG4gICAgICB9XG4gICAgICBjb25zdCB0cmltbWVkTGluZVRleHQgPSBsaW5lLnRyaW1TdGFydCgpXG4gICAgICBpZiAoZm91bmRMaXN0KSB7XG4gICAgICAgIGlmICghdHJpbW1lZExpbmVUZXh0LnN0YXJ0c1dpdGgoVE9DX0xJU1RfSVRFTV9CVUxMRVQpKSBicmVha1xuICAgICAgICBpZiAodHJpbW1lZExpbmVUZXh0LnN0YXJ0c1dpdGgoJyMnKSkgYnJlYWtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGlmICh0cmltbWVkTGluZVRleHQuc3RhcnRzV2l0aChUT0NfTElTVF9JVEVNX0JVTExFVCkpIHtcbiAgICAgICAgICBmb3VuZExpc3QgPSB0cnVlXG4gICAgICAgIH0gZWxzZSBpZiAodHJpbW1lZExpbmVUZXh0LnN0YXJ0c1dpdGgoJyMnKSkge1xuICAgICAgICAgIC8vIFJlYWNoZWQgdGhlIG5leHQgaGVhZGluZyB3aXRob3V0IGZpbmRpbmcgZXhpc3RpbmcgVE9DIGxpc3QsIGluc2VydCBhdCB0aGUgc3RhcnQgb2YgdGhlIFRPQyBzZWN0aW9uXG4gICAgICAgICAgZW5kaW5nTGluZSA9IHN0YXJ0aW5nTGluZVxuICAgICAgICAgIGJyZWFrXG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgY29udGludWVcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cblxuICAgIGlmICh0b2NCdWlsZGVyID09PSAnXFxuJykge1xuICAgICAgdG9jQnVpbGRlciA9ICcnXG4gICAgfVxuXG4gICAgY29uc3QgdG8gPSB7XG4gICAgICBsaW5lOiBlbmRpbmdMaW5lLFxuICAgICAgY2g6IDBcbiAgICB9XG4gICAgY29uc3QgcmFuZ2UgPSB7IGZyb20sIHRvIH1cbiAgICByZXBsYWNlUmFuZ2VTYWZlbHkoZWRpdG9yLCBjaGFuZ2VzLCByYW5nZSwgdG9jQnVpbGRlcilcbiAgfVxuXG4gIC8vIEV4ZWN1dGUgdGhlIHRyYW5zYWN0aW9uIHRvIG1ha2UgYWxsIHRoZSBjaGFuZ2VzIGF0IG9uY2VcbiAgaWYgKGNoYW5nZXMubGVuZ3RoID4gMCkge1xuICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby1jb25zb2xlXG4gICAgY29uc29sZS5sb2coJ051bWJlciBIZWFkaW5ncyBQbHVnaW46IEFwcGx5aW5nIHRhYmxlIG9mIGNvbnRlbnRzIGNoYW5nZXM6JywgY2hhbmdlcy5sZW5ndGgpXG4gICAgZWRpdG9yLnRyYW5zYWN0aW9uKHtcbiAgICAgIGNoYW5nZXM6IGNoYW5nZXNcbiAgICB9KVxuICB9XG59XG5cbmV4cG9ydCBjb25zdCByZW1vdmVIZWFkaW5nTnVtYmVyaW5nID0gKFxuICB2aWV3SW5mbzogVmlld0luZm8gfCB1bmRlZmluZWRcbik6IHZvaWQgPT4ge1xuICBpZiAoIXZpZXdJbmZvKSByZXR1cm5cbiAgY29uc3QgaGVhZGluZ3MgPSB2aWV3SW5mby5kYXRhLmhlYWRpbmdzID8/IFtdXG4gIGNvbnN0IGVkaXRvciA9IHZpZXdJbmZvLmVkaXRvclxuXG4gIGNvbnN0IGNoYW5nZXM6IEVkaXRvckNoYW5nZVtdID0gW11cblxuICBmb3IgKGNvbnN0IGhlYWRpbmcgb2YgaGVhZGluZ3MpIHtcbiAgICBjb25zdCBwcmVmaXhSYW5nZSA9IGdldEhlYWRpbmdQcmVmaXhSYW5nZShlZGl0b3IsIGhlYWRpbmcpXG4gICAgaWYgKHByZWZpeFJhbmdlID09PSB1bmRlZmluZWQpIHJldHVyblxuICAgIGNvbnN0IGhlYWRpbmdIYXNoU3RyaW5nID0gbWFrZUhlYWRpbmdIYXNoU3RyaW5nKGVkaXRvciwgaGVhZGluZylcbiAgICBpZiAoaGVhZGluZ0hhc2hTdHJpbmcgPT09IHVuZGVmaW5lZCkgcmV0dXJuXG4gICAgcmVwbGFjZVJhbmdlU2FmZWx5KGVkaXRvciwgY2hhbmdlcywgcHJlZml4UmFuZ2UsIGhlYWRpbmdIYXNoU3RyaW5nICsgJyAnKVxuICB9XG5cbiAgaWYgKGNoYW5nZXMubGVuZ3RoID4gMCkge1xuICAgIGVkaXRvci50cmFuc2FjdGlvbih7XG4gICAgICBjaGFuZ2VzOiBjaGFuZ2VzXG4gICAgfSlcbiAgfVxufVxuIiwiaW1wb3J0IHsgQXBwLCBQbHVnaW4sIFBsdWdpblNldHRpbmdUYWIsIFNldHRpbmcgfSBmcm9tICdvYnNpZGlhbidcclxuaW1wb3J0IHsgZ2V0Vmlld0luZm8sIGlzVmlld0FjdGl2ZSB9IGZyb20gJy4vYWN0aXZlVmlld0hlbHBlcnMnXHJcbmltcG9ydCB7IGdldEZyb250TWF0dGVyU2V0dGluZ3NPckFsdGVybmF0aXZlLCBzYXZlU2V0dGluZ3NUb0Zyb250TWF0dGVyIH0gZnJvbSAnLi9mcm9udE1hdHRlcidcclxuaW1wb3J0IHsgTnVtYmVyaW5nRG9uZUNvbmZpZywgc2hvd051bWJlcmluZ0RvbmVNZXNzYWdlIH0gZnJvbSAnLi9tZXNzYWdlcydcclxuaW1wb3J0IHsgcmVtb3ZlSGVhZGluZ051bWJlcmluZywgdXBkYXRlSGVhZGluZ051bWJlcmluZywgdXBkYXRlVGFibGVPZkNvbnRlbnRzIH0gZnJvbSAnLi9udW1iZXJpbmcnXHJcbmltcG9ydCB7IERFRkFVTFRfU0VUVElOR1MsIE51bWJlckhlYWRpbmdzUGx1Z2luU2V0dGluZ3MgfSBmcm9tICcuL3NldHRpbmdzVHlwZXMnXHJcblxyXG5jbGFzcyBOdW1iZXJIZWFkaW5nc1BsdWdpblNldHRpbmdUYWIgZXh0ZW5kcyBQbHVnaW5TZXR0aW5nVGFiIHtcclxuICBwbHVnaW46IE51bWJlckhlYWRpbmdzUGx1Z2luXHJcblxyXG4gIGNvbnN0cnVjdG9yIChhcHA6IEFwcCwgcGx1Z2luOiBOdW1iZXJIZWFkaW5nc1BsdWdpbikge1xyXG4gICAgc3VwZXIoYXBwLCBwbHVnaW4pXHJcbiAgICB0aGlzLnBsdWdpbiA9IHBsdWdpblxyXG4gIH1cclxuXHJcbiAgZGlzcGxheSAoKTogdm9pZCB7XHJcbiAgICBjb25zdCB7IGNvbnRhaW5lckVsIH0gPSB0aGlzXHJcblxyXG4gICAgY29udGFpbmVyRWwuZW1wdHkoKVxyXG5cclxuICAgIGNvbnRhaW5lckVsLmNyZWF0ZUVsKCdoMicsIHsgdGV4dDogJ051bWJlciBIZWFkaW5ncyAtIFNldHRpbmdzJyB9KVxyXG5cclxuICAgIGNvbnRhaW5lckVsLmNyZWF0ZUVsKCdkaXYnLCB7IHRleHQ6ICdUbyBhZGQgbnVtYmVyaW5nIHRvIHlvdXIgZG9jdW1lbnQsIGJyaW5nIHVwIHRoZSBjb21tYW5kIHdpbmRvdyAob24gTWFjLCB0eXBlIENNRCtQKSwgYW5kIHRoZW4gdHlwZSBcIk51bWJlciBIZWFkaW5nc1wiIHRvIHNlZSBhIGxpc3Qgb2YgYXZhaWxhYmxlIGNvbW1hbmRzLicgfSlcclxuXHJcbiAgICBjb250YWluZXJFbC5jcmVhdGVFbCgnYnInLCB7fSlcclxuXHJcbiAgICBjb250YWluZXJFbC5jcmVhdGVFbCgnZGl2JywgeyB0ZXh0OiAnSWYgdGhlIGRvY3VtZW50IGhhcyBmcm9udCBtYXR0ZXIgZGVmaW5lZCB3aXRoIHRoZSBiZWxvdyBzZXR0aW5ncywgdGhlIHByb2plY3Qtd2lkZSBzZXR0aW5ncyBkZWZpbmVkIG9uIHRoaXMgc2NyZWVuIHdpbGwgYmUgaWdub3JlZC4gWW91IGNhbiBkZWZpbmUgZnJvbnQgbWF0dGVyIGxpa2UgdGhpczonIH0pXHJcblxyXG4gICAgY29udGFpbmVyRWwuY3JlYXRlRWwoJ3ByZScsIHtcclxuICAgICAgdGV4dDogYCAgICAtLS1cclxuICAgIGFsaWFzOlxyXG4gICAgLSBFeGFtcGxlIEFsaWFzXHJcbiAgICB0YWdzOlxyXG4gICAgLSBleGFtcGxlLXRhZ1xyXG4gICAgbnVtYmVyIGhlYWRpbmdzOiBmaXJzdC1sZXZlbCAxLCBtYXggNiwgMS4xLCBhdXRvLCBjb250ZW50cyBedG9jXHJcbiAgICAtLS1gXHJcbiAgICB9KVxyXG5cclxuICAgIGNvbnRhaW5lckVsLmNyZWF0ZUVsKCdkaXYnLCB7XHJcbiAgICAgIHRleHQ6IGBcclxuICAgICAgVGhlICdudW1iZXIgaGVhZGluZ3MnIGZyb250IG1hdHRlciBrZXkgaXMgdXNlZCB0byBzdG9yZSBudW1iZXJpbmcgc2V0dGluZ3Mgc3BlY2lmaWMgdG8gdGhlIGZpbGUuIFRoZXJlIGFyZSBmb3VyIHBvc3NpYmxlIG9wdGlvbnNcclxuICAgICAgaW4gdGhlIHZhbHVlIHRvIHRoZSByaWdodCBvZiB0aGUgY29sb24sIHNlcGFyYXRlZCBieSBjb21tYXMuXHJcbiAgICBgXHJcbiAgICB9KVxyXG5cclxuICAgIGNvbnN0IHVsID0gY29udGFpbmVyRWwuY3JlYXRlRWwoJ3VsJywge30pXHJcblxyXG4gICAgY29uc3QgbGkwID0gdWwuY3JlYXRlRWwoJ2xpJywgeyB9KVxyXG4gICAgbGkwLmNyZWF0ZUVsKCdiJywgeyB0ZXh0OiAnQXV0b21hdGljIG51bWJlcmluZycgfSlcclxuICAgIGxpMC5jcmVhdGVFbCgnc3BhbicsIHsgdGV4dDogJzogSWYgXFwnYXV0b1xcJyBhcHBlYXJzLCB0aGUgZG9jdW1lbnQgd2lsbCBiZSBhdXRvbWF0aWNhbGx5IG51bWJlcmVkLicgfSlcclxuXHJcbiAgICBjb25zdCBsaTEgPSB1bC5jcmVhdGVFbCgnbGknLCB7IH0pXHJcbiAgICBsaTEuY3JlYXRlRWwoJ2InLCB7IHRleHQ6ICdGaXJzdCBsZXZlbCB0byBudW1iZXInIH0pXHJcbiAgICBsaTEuY3JlYXRlRWwoJ3NwYW4nLCB7IHRleHQ6ICc6IElmIFxcJ2ZpcnN0LWxldmVsIDJcXCcgYXBwZWFycywgdGhlIG51bWJlcmluZyB3aWxsIHN0YXJ0IGF0IHRoZSBzZWNvbmQgbGV2ZWwnIH0pXHJcblxyXG4gICAgY29uc3QgbGkyID0gdWwuY3JlYXRlRWwoJ2xpJywgeyB9KVxyXG4gICAgbGkyLmNyZWF0ZUVsKCdiJywgeyB0ZXh0OiAnTWF4aW11bSBsZXZlbCB0byBudW1iZXInIH0pXHJcbiAgICBsaTIuY3JlYXRlRWwoJ3NwYW4nLCB7IHRleHQ6ICc6IElmIFxcJ21heCA2XFwnIGFwcGVhcnMsIHRoZSBoZWFkaW5ncyBhYm92ZSBsZXZlbCA2IHdpbGwgYmUgc2tpcHBlZC4nIH0pXHJcblxyXG4gICAgY29uc3QgbGkzID0gdWwuY3JlYXRlRWwoJ2xpJywgeyB9KVxyXG4gICAgbGkzLmNyZWF0ZUVsKCdiJywgeyB0ZXh0OiAnVGFibGUgb2YgY29udGVudHMgYW5jaG9yJyB9KVxyXG4gICAgbGkzLmNyZWF0ZUVsKCdzcGFuJywgeyB0ZXh0OiAnOiBJZiBcXCdjb250ZW50cyBedG9jXFwnIGFwcGVhcnMsIHRoZSBoZWFkaW5nIHRoYXQgZW5kcyB3aXRoIHRoZSBhbmNob3IgXnRvYyB3aWxsIGhhdmUgYSB0YWJsZSBvZiBjb250ZW50cyBpbnNlcnRlZCBiZW5lYXRoIGl0LicgfSlcclxuXHJcbiAgICBjb25zdCBsaTQgPSB1bC5jcmVhdGVFbCgnbGknLCB7IH0pXHJcbiAgICBsaTQuY3JlYXRlRWwoJ2InLCB7IHRleHQ6ICdOdW1iZXJpbmcgc3R5bGUnIH0pXHJcbiAgICBsaTQuY3JlYXRlRWwoJ3NwYW4nLCB7XHJcbiAgICAgIHRleHQ6IGA6XHJcbiAgICAgIEEgc3R5bGUgdGV4dCBsaWtlICcxLjEnLCAnQS4xJywgb3IgJ18uMS4xJyB0ZWxscyB0aGUgcGx1Z2luIGhvdyB0byBmb3JtYXQgdGhlIGhlYWRpbmdzLlxyXG4gICAgICBJZiBhIHN0eWxlIHN0cmluZyBlbmRzIHdpdGggJy4nIChhIGRvdCksICc6JyAoYSBjb2xvbiksIG9yICctJyAoYSBkYXNoKSwgdGhlIGhlYWRpbmcgbnVtYmVycyB3aWxsIGJlIHNlcGFyYXRlZCBmcm9tIHRoZSBoZWFkaW5nIHRpdGxlXHJcbiAgICAgIHdpdGggdGhhdCBzeW1ib2wuYFxyXG4gICAgfSlcclxuXHJcbiAgICBjb25zdCB1bDMgPSBsaTQuY3JlYXRlRWwoJ3VsJywge30pXHJcbiAgICB1bDMuY3JlYXRlRWwoJ2xpJywge1xyXG4gICAgICB0ZXh0OiBgICAgICAgXHJcbiAgICAgIEZvciBleGFtcGxlLCAnMS4xJyBtZWFucyBib3RoIHRvcCBsZXZlbCBhbmQgb3RoZXIgaGVhZGluZ3Mgd2lsbCBiZSBudW1iZXJlZCBzdGFydGluZyBmcm9tICcxJy5cclxuICAgIGBcclxuICAgIH0pXHJcbiAgICB1bDMuY3JlYXRlRWwoJ2xpJywge1xyXG4gICAgICB0ZXh0OiBgICAgICAgXHJcbiAgICAgIEZvciBleGFtcGxlLCAnQS4xJyBtZWFucyB0b3AgbGV2ZWwgaGVhZGluZ3Mgd2lsbCBiZSBudW1iZXJlZCBzdGFydGluZyBmcm9tICdBJy5cclxuICAgIGBcclxuICAgIH0pXHJcbiAgICB1bDMuY3JlYXRlRWwoJ2xpJywge1xyXG4gICAgICB0ZXh0OiBgICAgICAgXHJcbiAgICAgIEZvciBleGFtcGxlLCAnXy5BLjEnIG1lYW5zIHRvcCBsZXZlbCBoZWFkaW5ncyB3aWxsIE5PVCBiZSBudW1iZXJlZCwgYnV0IHRoZSBuZXh0IGxldmVscyB3aWxsIGJlIG51bWJlcmVkIHdpdGggbGV0dGVycyBhbmQgbnVtYmVycy5cclxuICAgIGBcclxuICAgIH0pXHJcbiAgICB1bDMuY3JlYXRlRWwoJ2xpJywge1xyXG4gICAgICB0ZXh0OiBgICAgICAgXHJcbiAgICAgIEZvciBleGFtcGxlLCAnMS4xOicgbWVhbnMgaGVhZGluZ3Mgd2lsbCBsb29rIGxpa2UgJyMjIDIuNDogRXhhbXBsZSBIZWFkaW5nJ1xyXG4gICAgYFxyXG4gICAgfSlcclxuICAgIHVsMy5jcmVhdGVFbCgnbGknLCB7XHJcbiAgICAgIHRleHQ6IGAgICAgICBcclxuICAgICAgRm9yIGV4YW1wbGUsICdBLjEtJyBtZWFucyBoZWFkaW5ncyB3aWxsIGxvb2sgbGlrZSAnIyMgQi41LSBFeGFtcGxlIEhlYWRpbmcnXHJcbiAgICBgXHJcbiAgICB9KVxyXG5cclxuICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxyXG4gICAgICAuc2V0TmFtZSgnU2tpcCB0b3AgaGVhZGluZyBsZXZlbCcpXHJcbiAgICAgIC5zZXREZXNjKCdJZiBzZWxlY3RlZCwgbnVtYmVyaW5nIHdpbGwgbm90IGJlIGFwcGxpZWQgdG8gdGhlIHRvcCBoZWFkaW5nIGxldmVsLicpXHJcbiAgICAgIC5hZGRUb2dnbGUodG9nZ2xlID0+IHRvZ2dsZVxyXG4gICAgICAgIC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5za2lwVG9wTGV2ZWwpXHJcbiAgICAgICAgLnNldFRvb2x0aXAoJ1NraXAgdG9wIGhlYWRpbmcgbGV2ZWwnKVxyXG4gICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcclxuICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLnNraXBUb3BMZXZlbCA9IHZhbHVlXHJcbiAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKVxyXG4gICAgICAgIH0pKVxyXG5cclxuICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxyXG4gICAgICAuc2V0TmFtZSgnRmlyc3QgaGVhZGluZyBsZXZlbCcpXHJcbiAgICAgIC5zZXREZXNjKCdGaXJzdCBoZWFkaW5nIGxldmVsIHRvIG51bWJlci4nKVxyXG4gICAgICAuYWRkU2xpZGVyKHNsaWRlciA9PiBzbGlkZXJcclxuICAgICAgICAuc2V0TGltaXRzKDEsIDYsIDEpXHJcbiAgICAgICAgLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLmZpcnN0TGV2ZWwpXHJcbiAgICAgICAgLnNldER5bmFtaWNUb29sdGlwKClcclxuICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XHJcbiAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5maXJzdExldmVsID0gdmFsdWVcclxuICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpXHJcbiAgICAgICAgfSkpXHJcblxyXG4gICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXHJcbiAgICAgIC5zZXROYW1lKCdNYXhpbXVtIGhlYWRpbmcgbGV2ZWwnKVxyXG4gICAgICAuc2V0RGVzYygnTWF4aW11bSBoZWFkaW5nIGxldmVsIHRvIG51bWJlci4nKVxyXG4gICAgICAuYWRkU2xpZGVyKHNsaWRlciA9PiBzbGlkZXJcclxuICAgICAgICAuc2V0TGltaXRzKDEsIDYsIDEpXHJcbiAgICAgICAgLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLm1heExldmVsKVxyXG4gICAgICAgIC5zZXREeW5hbWljVG9vbHRpcCgpXHJcbiAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xyXG4gICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MubWF4TGV2ZWwgPSB2YWx1ZVxyXG4gICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKClcclxuICAgICAgICB9KSlcclxuXHJcbiAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbClcclxuICAgICAgLnNldE5hbWUoJ1N0eWxlIGZvciBsZXZlbCAxIGhlYWRpbmdzJylcclxuICAgICAgLnNldERlc2MoJ0RlZmluZXMgdGhlIG51bWJlcmluZyBzdHlsZSBmb3IgbGV2ZWwgb25lIGhlYWRpbmdzLiBWYWxpZCB2YWx1ZXMgYXJlIDEgKGZvciBudW1iZXJzKSBvciBBIChmb3IgY2FwaXRhbCBsZXR0ZXJzKS4nKVxyXG4gICAgICAuYWRkVGV4dCh0ZXh0ID0+IHRleHRcclxuICAgICAgICAuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3Muc3R5bGVMZXZlbDEpXHJcbiAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xyXG4gICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3Muc3R5bGVMZXZlbDEgPSB2YWx1ZVxyXG4gICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKClcclxuICAgICAgICB9KSlcclxuXHJcbiAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbClcclxuICAgICAgLnNldE5hbWUoJ1N0eWxlIGZvciBsb3dlciBsZXZlbCBoZWFkaW5ncyAoYmVsb3cgbGV2ZWwgMSknKVxyXG4gICAgICAuc2V0RGVzYygnRGVmaW5lcyB0aGUgbnVtYmVyaW5nIHN0eWxlIGZvciBoZWFkaW5ncyBiZWxvdyBsZXZlbCBvbmUuIFZhbGlkIHZhbHVlcyBhcmUgMSAoZm9yIG51bWJlcnMpIG9yIEEgKGZvciBjYXBpdGFsIGxldHRlcnMpLicpXHJcbiAgICAgIC5hZGRUZXh0KHRleHQgPT4gdGV4dFxyXG4gICAgICAgIC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5zdHlsZUxldmVsT3RoZXIpXHJcbiAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xyXG4gICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3Muc3R5bGVMZXZlbE90aGVyID0gdmFsdWVcclxuICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpXHJcbiAgICAgICAgfSkpXHJcblxyXG4gICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXHJcbiAgICAgIC5zZXROYW1lKCdBdXRvbWF0aWMgbnVtYmVyaW5nJylcclxuICAgICAgLnNldERlc2MoJ1R1cm5zIG9uIGF1dG9tYXRpYyBudW1iZXJpbmcgb2YgZG9jdW1lbnRzLicpXHJcbiAgICAgIC5hZGRUb2dnbGUodG9nZ2xlID0+IHRvZ2dsZVxyXG4gICAgICAgIC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5hdXRvKVxyXG4gICAgICAgIC5zZXRUb29sdGlwKCdUdXJuIG9uIGF1dG9tYXRpYyBudW1iZXJpbmcnKVxyXG4gICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcclxuICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLmF1dG8gPSB2YWx1ZVxyXG4gICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKClcclxuICAgICAgICB9KSlcclxuXHJcbiAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbClcclxuICAgICAgLnNldE5hbWUoJ1NlcGFyYXRvciBzdHlsZScpXHJcbiAgICAgIC5zZXREZXNjKCdEZWZpbmVzIHRoZSBzZXBhcmF0b3Igc3R5bGUgYmV0d2VlbiB0aGUgaGVhZGluZyBudW1iZXIgYW5kIHRoZSBoZWFkaW5nIHRleHQuIFZhbGlkIHZhbHVlcyBhcmUgOiAoY29sb24pIG9yIC4gKGRvdCkgb3IgLSAoZGFzaCkuIFlvdSBjYW4gYWxzbyBsZWF2ZSBpdCBibGFuayBmb3Igbm8gc2VwYXJhdG9yLicpXHJcbiAgICAgIC5hZGRUZXh0KHRleHQgPT4gdGV4dFxyXG4gICAgICAgIC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5zZXBhcmF0b3IpXHJcbiAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xyXG4gICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3Muc2VwYXJhdG9yID0gdmFsdWVcclxuICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpXHJcbiAgICAgICAgfSkpXHJcblxyXG4gICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXHJcbiAgICAgIC5zZXROYW1lKCdUYWJsZSBvZiBDb250ZW50cyBBbmNob3InKVxyXG4gICAgICAuc2V0RGVzYygnQW5jaG9yIHdoaWNoIGxhYmVscyB0aGUgaGVhZGVyIHdoZXJlIGEgdGFibGUgb2YgY29udGVudHMgc2hvdWxkIGJlIGluc2VydGVkLiBUaGUgYW5jaG9yIHNob3VsZCBiZSBhZGRlZCBhdCB0aGUgZW5kIG9mIGEgaGVhZGVyLiBGb3IgZXhhbXBsZSwgXnRvYy4nKVxyXG4gICAgICAuYWRkVGV4dCh0ZXh0ID0+IHRleHRcclxuICAgICAgICAuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MuY29udGVudHMpXHJcbiAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xyXG4gICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MuY29udGVudHMgPSB2YWx1ZVxyXG4gICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKClcclxuICAgICAgICB9KSlcclxuICB9XHJcbn1cclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIE51bWJlckhlYWRpbmdzUGx1Z2luIGV4dGVuZHMgUGx1Z2luIHtcclxuICBzZXR0aW5ncyE6IE51bWJlckhlYWRpbmdzUGx1Z2luU2V0dGluZ3NcclxuXHJcbiAgYXN5bmMgb25sb2FkICgpOiBQcm9taXNlPHZvaWQ+IHtcclxuICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby1jb25zb2xlXHJcbiAgICBjb25zb2xlLmluZm8oJ0xvYWRpbmcgTnVtYmVyIEhlYWRpbmdzIFBsdWdpbiwgdmVyc2lvbiAnICsgdGhpcy5tYW5pZmVzdC52ZXJzaW9uKVxyXG5cclxuICAgIGF3YWl0IHRoaXMubG9hZFNldHRpbmdzKClcclxuXHJcbiAgICB0aGlzLmFkZENvbW1hbmQoe1xyXG4gICAgICBpZDogJ251bWJlci1oZWFkaW5ncycsXHJcbiAgICAgIG5hbWU6ICdOdW1iZXIgYWxsIGhlYWRpbmdzIGluIGRvY3VtZW50JyxcclxuICAgICAgY2hlY2tDYWxsYmFjazogKGNoZWNraW5nOiBib29sZWFuKSA9PiB7XHJcbiAgICAgICAgaWYgKGNoZWNraW5nKSByZXR1cm4gaXNWaWV3QWN0aXZlKHRoaXMuYXBwKVxyXG5cclxuICAgICAgICBjb25zdCB2aWV3SW5mbyA9IGdldFZpZXdJbmZvKHRoaXMuYXBwKVxyXG4gICAgICAgIGlmICh2aWV3SW5mbykge1xyXG4gICAgICAgICAgY29uc3Qgc2V0dGluZ3MgPSBnZXRGcm9udE1hdHRlclNldHRpbmdzT3JBbHRlcm5hdGl2ZSh2aWV3SW5mby5kYXRhLCB0aGlzLnNldHRpbmdzKVxyXG4gICAgICAgICAgdXBkYXRlSGVhZGluZ051bWJlcmluZyh2aWV3SW5mbywgc2V0dGluZ3MpXHJcbiAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHtcclxuICAgICAgICAgICAgLy8gSEFDSzogVGhpcyBtdXN0IGhhcHBlbiBhZnRlciBhIHRpbWVvdXQgc28gdGhhdCB0aGVyZSBpcyB0aW1lIGZvciB0aGUgZWRpdG9yIHRyYW5zYWN0aW9uIHRvIGNvbXBsZXRlXHJcbiAgICAgICAgICAgIGNvbnN0IHBvc3ROdW1iZXJpbmdWaWV3SW5mbyA9IGdldFZpZXdJbmZvKHRoaXMuYXBwKVxyXG4gICAgICAgICAgICB1cGRhdGVUYWJsZU9mQ29udGVudHMocG9zdE51bWJlcmluZ1ZpZXdJbmZvLCBzZXR0aW5ncylcclxuICAgICAgICAgIH0sIDMwMDApXHJcblxyXG4gICAgICAgICAgY29uc3Qgc2F2ZVNldHRpbmdzQ2FsbGJhY2sgPSAoc2hvdWxkQWRkQXV0b0ZsYWc6IGJvb2xlYW4pOiB2b2lkID0+IHtcclxuICAgICAgICAgICAgY29uc3QgdHdlYWtlZFNldHRpbmdzID0geyAuLi5zZXR0aW5ncyB9XHJcbiAgICAgICAgICAgIGlmIChzaG91bGRBZGRBdXRvRmxhZykgdHdlYWtlZFNldHRpbmdzLmF1dG8gPSB0cnVlXHJcbiAgICAgICAgICAgIHNhdmVTZXR0aW5nc1RvRnJvbnRNYXR0ZXIodmlld0luZm8uZGF0YSwgdmlld0luZm8uZWRpdG9yLCB0d2Vha2VkU2V0dGluZ3MpXHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgICBjb25zdCBjb25maWc6IE51bWJlcmluZ0RvbmVDb25maWcgPSB7XHJcbiAgICAgICAgICAgIG1lc3NhZ2U6IGBTdWNjZXNzZnVsbHkgdXBkYXRlZCBhbGwgaGVhZGluZyBudW1iZXJzIGluIHRoZSBkb2N1bWVudCwgdXNpbmcgdGhlIHNldHRpbmdzIGJlbG93LiBcclxuICAgICAgICAgICAgICBTZWUgc2V0dGluZ3MgcGFuZWwgdG8gY2hhbmdlIGhvdyBoZWFkaW5ncyBhcmUgbnVtYmVyZWQsIG9yIHVzZSBmcm9udCBtYXR0ZXJcclxuICAgICAgICAgICAgICAoc2VlIHNldHRpbmdzIHBhbmVsKS5gLFxyXG4gICAgICAgICAgICBwcmVmb3JtYXR0ZWRNZXNzYWdlOiBgICBTa2lwIHRvcCBoZWFkaW5nIGxldmVsOiAke3NldHRpbmdzLnNraXBUb3BMZXZlbH1cclxuICBGaXJzdCBoZWFkaW5nIGxldmVsOiAke3NldHRpbmdzLmZpcnN0TGV2ZWx9XHJcbiAgTWF4aW11bSBoZWFkaW5nIGxldmVsOiAke3NldHRpbmdzLm1heExldmVsfVxyXG4gIFN0eWxlIGZvciBsZXZlbCAxIGhlYWRpbmdzOiAke3NldHRpbmdzLnN0eWxlTGV2ZWwxfVxyXG4gIFN0eWxlIGZvciBsb3dlciBsZXZlbCBoZWFkaW5ncyAoYmVsb3cgbGV2ZWwgMSk6ICR7c2V0dGluZ3Muc3R5bGVMZXZlbE90aGVyfVxyXG4gIFNlcGFyYXRvcjogJHtzZXR0aW5ncy5zZXBhcmF0b3J9XHJcbiAgVGFibGUgb2YgQ29udGVudHMgQW5jaG9yOiAke3NldHRpbmdzLmNvbnRlbnRzfWAsXHJcbiAgICAgICAgICAgIHNhdmVTZXR0aW5nc0NhbGxiYWNrXHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgICBzaG93TnVtYmVyaW5nRG9uZU1lc3NhZ2UodGhpcy5hcHAsIGNvbmZpZylcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHJldHVybiBmYWxzZVxyXG4gICAgICB9XHJcbiAgICB9KVxyXG5cclxuICAgIHRoaXMuYWRkQ29tbWFuZCh7XHJcbiAgICAgIGlkOiAncmVtb3ZlLW51bWJlci1oZWFkaW5ncycsXHJcbiAgICAgIG5hbWU6ICdSZW1vdmUgbnVtYmVyaW5nIGZyb20gYWxsIGhlYWRpbmdzIGluIGRvY3VtZW50JyxcclxuICAgICAgY2hlY2tDYWxsYmFjazogKGNoZWNraW5nOiBib29sZWFuKSA9PiB7XHJcbiAgICAgICAgaWYgKGNoZWNraW5nKSByZXR1cm4gaXNWaWV3QWN0aXZlKHRoaXMuYXBwKVxyXG5cclxuICAgICAgICBjb25zdCB2aWV3SW5mbyA9IGdldFZpZXdJbmZvKHRoaXMuYXBwKVxyXG4gICAgICAgIHJlbW92ZUhlYWRpbmdOdW1iZXJpbmcodmlld0luZm8pXHJcblxyXG4gICAgICAgIHJldHVybiB0cnVlXHJcbiAgICAgIH1cclxuICAgIH0pXHJcblxyXG4gICAgdGhpcy5hZGRDb21tYW5kKHtcclxuICAgICAgaWQ6ICdzYXZlLXNldHRpbmdzLXRvLWZyb250LW1hdHRlcicsXHJcbiAgICAgIG5hbWU6ICdTYXZlIHNldHRpbmdzIHRvIGZyb250IG1hdHRlcicsXHJcbiAgICAgIGNoZWNrQ2FsbGJhY2s6IChjaGVja2luZzogYm9vbGVhbikgPT4ge1xyXG4gICAgICAgIGlmIChjaGVja2luZykgcmV0dXJuIGlzVmlld0FjdGl2ZSh0aGlzLmFwcClcclxuXHJcbiAgICAgICAgY29uc3Qgdmlld0luZm8gPSBnZXRWaWV3SW5mbyh0aGlzLmFwcClcclxuICAgICAgICBpZiAodmlld0luZm8pIHtcclxuICAgICAgICAgIGNvbnN0IHNldHRpbmdzID0gZ2V0RnJvbnRNYXR0ZXJTZXR0aW5nc09yQWx0ZXJuYXRpdmUodmlld0luZm8uZGF0YSwgdGhpcy5zZXR0aW5ncylcclxuICAgICAgICAgIHNhdmVTZXR0aW5nc1RvRnJvbnRNYXR0ZXIodmlld0luZm8uZGF0YSwgdmlld0luZm8uZWRpdG9yLCBzZXR0aW5ncylcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHJldHVybiBmYWxzZVxyXG4gICAgICB9XHJcbiAgICB9KVxyXG5cclxuICAgIHRoaXMuYWRkU2V0dGluZ1RhYihuZXcgTnVtYmVySGVhZGluZ3NQbHVnaW5TZXR0aW5nVGFiKHRoaXMuYXBwLCB0aGlzKSlcclxuXHJcbiAgICB0aGlzLnJlZ2lzdGVySW50ZXJ2YWwod2luZG93LnNldEludGVydmFsKCgpID0+IHtcclxuICAgICAgY29uc3Qgdmlld0luZm8gPSBnZXRWaWV3SW5mbyh0aGlzLmFwcClcclxuICAgICAgaWYgKHZpZXdJbmZvKSB7XHJcbiAgICAgICAgY29uc3Qgc2V0dGluZ3MgPSBnZXRGcm9udE1hdHRlclNldHRpbmdzT3JBbHRlcm5hdGl2ZSh2aWV3SW5mby5kYXRhLCB0aGlzLnNldHRpbmdzKVxyXG5cclxuICAgICAgICBpZiAoc2V0dGluZ3MuYXV0bykge1xyXG4gICAgICAgICAgdXBkYXRlSGVhZGluZ051bWJlcmluZyh2aWV3SW5mbywgc2V0dGluZ3MpXHJcbiAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHtcclxuICAgICAgICAgICAgLy8gSEFDSzogVGhpcyBtdXN0IGhhcHBlbiBhZnRlciBhIHRpbWVvdXQgc28gdGhhdCB0aGVyZSBpcyB0aW1lIGZvciB0aGUgZWRpdG9yIHRyYW5zYWN0aW9uIHRvIGNvbXBsZXRlXHJcbiAgICAgICAgICAgIGNvbnN0IHBvc3ROdW1iZXJpbmdWaWV3SW5mbyA9IGdldFZpZXdJbmZvKHRoaXMuYXBwKVxyXG4gICAgICAgICAgICB1cGRhdGVUYWJsZU9mQ29udGVudHMocG9zdE51bWJlcmluZ1ZpZXdJbmZvLCBzZXR0aW5ncylcclxuICAgICAgICAgIH0sIDMwMDApXHJcbiAgICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tY29uc29sZVxyXG4gICAgICAgICAgY29uc29sZS5sb2coJ051bWJlciBIZWFkaW5ncyBQbHVnaW46IEF1dG9tYXRpY2FsbHkgbnVtYmVyZWQgZG9jdW1lbnQnKVxyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgfSwgMTAgKiAxMDAwKSlcclxuICB9XHJcblxyXG4gIGFzeW5jIGxvYWRTZXR0aW5ncyAoKTogUHJvbWlzZTx2b2lkPiB7XHJcbiAgICB0aGlzLnNldHRpbmdzID0gT2JqZWN0LmFzc2lnbih7fSwgREVGQVVMVF9TRVRUSU5HUywgYXdhaXQgdGhpcy5sb2FkRGF0YSgpKVxyXG4gIH1cclxuXHJcbiAgYXN5bmMgc2F2ZVNldHRpbmdzICgpOiBQcm9taXNlPHZvaWQ+IHtcclxuICAgIGF3YWl0IHRoaXMuc2F2ZURhdGEodGhpcy5zZXR0aW5ncylcclxuICB9XHJcbn1cclxuIl0sIm5hbWVzIjpbIk1hcmtkb3duVmlldyIsInBhcnNlRnJvbnRNYXR0ZXJFbnRyeSIsIk1vZGFsIiwiUGx1Z2luU2V0dGluZ1RhYiIsIlNldHRpbmciLCJQbHVnaW4iXSwibWFwcGluZ3MiOiI7Ozs7Ozs7OztBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUF1REE7QUFDTyxTQUFTLFNBQVMsQ0FBQyxPQUFPLEVBQUUsVUFBVSxFQUFFLENBQUMsRUFBRSxTQUFTLEVBQUU7QUFDN0QsSUFBSSxTQUFTLEtBQUssQ0FBQyxLQUFLLEVBQUUsRUFBRSxPQUFPLEtBQUssWUFBWSxDQUFDLEdBQUcsS0FBSyxHQUFHLElBQUksQ0FBQyxDQUFDLFVBQVUsT0FBTyxFQUFFLEVBQUUsT0FBTyxDQUFDLEtBQUssQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLEVBQUU7QUFDaEgsSUFBSSxPQUFPLEtBQUssQ0FBQyxLQUFLLENBQUMsR0FBRyxPQUFPLENBQUMsRUFBRSxVQUFVLE9BQU8sRUFBRSxNQUFNLEVBQUU7QUFDL0QsUUFBUSxTQUFTLFNBQVMsQ0FBQyxLQUFLLEVBQUUsRUFBRSxJQUFJLEVBQUUsSUFBSSxDQUFDLFNBQVMsQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsT0FBTyxDQUFDLEVBQUUsRUFBRSxNQUFNLENBQUMsQ0FBQyxDQUFDLENBQUMsRUFBRSxFQUFFO0FBQ25HLFFBQVEsU0FBUyxRQUFRLENBQUMsS0FBSyxFQUFFLEVBQUUsSUFBSSxFQUFFLElBQUksQ0FBQyxTQUFTLENBQUMsT0FBTyxDQUFDLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsT0FBTyxDQUFDLEVBQUUsRUFBRSxNQUFNLENBQUMsQ0FBQyxDQUFDLENBQUMsRUFBRSxFQUFFO0FBQ3RHLFFBQVEsU0FBUyxJQUFJLENBQUMsTUFBTSxFQUFFLEVBQUUsTUFBTSxDQUFDLElBQUksR0FBRyxPQUFPLENBQUMsTUFBTSxDQUFDLEtBQUssQ0FBQyxHQUFHLEtBQUssQ0FBQyxNQUFNLENBQUMsS0FBSyxDQUFDLENBQUMsSUFBSSxDQUFDLFNBQVMsRUFBRSxRQUFRLENBQUMsQ0FBQyxFQUFFO0FBQ3RILFFBQVEsSUFBSSxDQUFDLENBQUMsU0FBUyxHQUFHLFNBQVMsQ0FBQyxLQUFLLENBQUMsT0FBTyxFQUFFLFVBQVUsSUFBSSxFQUFFLENBQUMsRUFBRSxJQUFJLEVBQUUsQ0FBQyxDQUFDO0FBQzlFLEtBQUssQ0FB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
